---
title: Administración del ciclo de vida de los documentos de producto almacenados en SharePoint Online mediante etiquetas de retención
ms.author: laurawi
author: laurawi
manager: laurawi
audience: Admin
ms.topic: article
ms.service: O365-seccomp
localization_priority: Priority
ms.collection:
- M365-security-compliance
- SPO_Content
search.appverid:
- MOE150
- MET150
description: Este escenario de solución muestra cómo administrar el ciclo de vida de los documentos relacionados con el producto y almacenados en SharePoint Online mediante las etiquetas de retención de Office 365. Esto se lleva a cabo con el uso de metadatos del documento para clasificar el contenido y, en concreto, al aplicar automáticamente las etiquetas de retención de Office 365 y configurar la retención basada en eventos.
ms.openlocfilehash: 3c9afd05fd4f59a5136ab12dbd7558ade3073e43
ms.sourcegitcommit: bf30a2314376f0b7d577741b97df017969737d11
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 11/27/2019
ms.locfileid: "39638084"
---
# <a name="manage-the-lifecycle-of-sharepoint-documents-with-retention-labels"></a><span data-ttu-id="76f91-104">Administración del ciclo de vida de documentos de SharePoint con etiquetas de retención</span><span class="sxs-lookup"><span data-stu-id="76f91-104">Manage the lifecycle of SharePoint documents with retention labels</span></span>

<span data-ttu-id="76f91-105">En este artículo se describe cómo administrar el ciclo de vida de los documentos relacionados con el producto que se almacenan en SharePoint Online mediante las etiquetas de retención de Office 365 y, específicamente, con la aplicación automática de etiquetas y la configuración de la retención basada en eventos.</span><span class="sxs-lookup"><span data-stu-id="76f91-105">This article describes how you can manage the lifecycle of product-related documents stored in SharePoint Online by using Office 365 retention labels, and specifically by auto-applying labels and configuring event-based retention.</span></span> <span data-ttu-id="76f91-106">La función de aplicación automática aprovecha la clasificación de documentos por el uso de los metadatos de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="76f91-106">The auto-apply functionality leverages document classification by the use of SharePoint metadata.</span></span> <span data-ttu-id="76f91-107">El escenario de este artículo se basa en documentos relacionados con el producto, pero los mismos conceptos pueden usarse en otros escenarios.</span><span class="sxs-lookup"><span data-stu-id="76f91-107">The scenario in this article is based on product-related documents, but the same concepts can be used for other scenarios.</span></span> <span data-ttu-id="76f91-108">Por ejemplo, en la industria del petróleo y gas, podría administrar el ciclo de vida de los documentos relacionados con los activos físicos, como plataformas petrolíferas, registros de pozos y licencias de producción.</span><span class="sxs-lookup"><span data-stu-id="76f91-108">For example, in the oil and gas industry, you could manage the lifecycle of documents related to physical assets such as oil platforms, well logs, or production licenses.</span></span> <span data-ttu-id="76f91-109">En la industria de servicios financieros, puede administrar documentos relacionados con cuentas bancarias, hipotecas y contratos de seguros.</span><span class="sxs-lookup"><span data-stu-id="76f91-109">In the financial services industry, you can manage documents related to bank accounts, mortgages, or insurance contracts.</span></span> <span data-ttu-id="76f91-110">En el sector público, puede administrar documentos relacionados con permisos de construcción o formularios fiscales.</span><span class="sxs-lookup"><span data-stu-id="76f91-110">In the public sector, you can manage documents related to construction permits or tax forms.</span></span>

<span data-ttu-id="76f91-111">Echemos un vistazo al escenario de este artículo.</span><span class="sxs-lookup"><span data-stu-id="76f91-111">Let's look at the scenario for this article.</span></span> <span data-ttu-id="76f91-112">Revisaremos la arquitectura de la información y la definición de las etiquetas de retención.</span><span class="sxs-lookup"><span data-stu-id="76f91-112">We'll look at the information architecture and the definition of the retention labels.</span></span> <span data-ttu-id="76f91-113">Luego, analizaremos la clasificación de documentos aplicando automáticamente las etiquetas y, por último, generaremos los eventos que desencadenan el inicio del periodo de retención.</span><span class="sxs-lookup"><span data-stu-id="76f91-113">Then we'll look at classifying documents by auto-applying the labels, and finally generating the events that initiate the start of the retention period.</span></span>

## <a name="information-architecture"></a><span data-ttu-id="76f91-114">Arquitectura de información</span><span class="sxs-lookup"><span data-stu-id="76f91-114">Information architecture</span></span>

<span data-ttu-id="76f91-115">El escenario para este artículo se basa en una empresa manufacturera que usa Office 365 SharePoint Online para almacenar todos los documentos relacionados con los productos que la empresa desarrolla.</span><span class="sxs-lookup"><span data-stu-id="76f91-115">The scenario for this article is based on a manufacturing company that uses Office 365 SharePoint Online to store all the documents related to the products the company develops.</span></span> <span data-ttu-id="76f91-116">Estos documentos incluyen especificaciones del producto, acuerdos con proveedores y manuales del usuario.</span><span class="sxs-lookup"><span data-stu-id="76f91-116">These documents include product specifications, agreements with suppliers, and user manuals.</span></span> <span data-ttu-id="76f91-117">Cuando se almacenan estos documentos en SharePoint como parte de las directivas de Administración de contenido empresarial, se definen los metadatos del documento y se usan para clasificarlos.</span><span class="sxs-lookup"><span data-stu-id="76f91-117">When these documents are stored in SharePoint as part of the Enterprise Content Management policies, document metadata is defined and used to classify them.</span></span> <span data-ttu-id="76f91-118">Cada documento tiene las siguientes propiedades de metadatos:</span><span class="sxs-lookup"><span data-stu-id="76f91-118">Each rule has the following properties:</span></span>

- <span data-ttu-id="76f91-119">**Tipo de documento** (como, por ejemplo, especificaciones del producto, acuerdo del producto y manual del usuario).</span><span class="sxs-lookup"><span data-stu-id="76f91-119">**Doc Type** (such as product specification, agreement, and user manual)</span></span>

- <span data-ttu-id="76f91-120">**Nombre del producto**.</span><span class="sxs-lookup"><span data-stu-id="76f91-120">**Product name**</span></span>

- <span data-ttu-id="76f91-121">**Estado** (borrador o final).</span><span class="sxs-lookup"><span data-stu-id="76f91-121">**Status** (draft or final)</span></span>

<span data-ttu-id="76f91-122">Estos metadatos forman el tipo de contenido base denominado **Documento de producción** para todos los documentos.</span><span class="sxs-lookup"><span data-stu-id="76f91-122">This metadata forms the base content type called **Production Document** for all documents.</span></span>

![Metadatos para la documentación del producto.](media/SPRetention1.png)

> [!NOTE]
> <span data-ttu-id="76f91-124">Las directivas de retención usan las propiedades **Tipo de documento** y **Estado** más tarde en el escenario para clasificar y aplicar automáticamente las etiquetas de retención.</span><span class="sxs-lookup"><span data-stu-id="76f91-124">The **Doc Type** and **Status** properties are used by retention policies later in the scenario to classify and auto-apply retention labels.</span></span>

<span data-ttu-id="76f91-125">Podemos tener varios tipos de contenido que representen diferentes tipos de documentos, pero vamos a centrarnos en la Documentación del producto.</span><span class="sxs-lookup"><span data-stu-id="76f91-125">We can have several content types that represent different types of documents, but let's focus on the Product Documentation.</span></span>

<span data-ttu-id="76f91-126">En este escenario, usamos el servicio de Metadatos administrados y el Almacén de términos para crear un conjunto de términos para **Tipo de documento** y otro para **Nombre de producto**.</span><span class="sxs-lookup"><span data-stu-id="76f91-126">In this scenario, we use the Managed Metadata service and the Term store to create a term set for **Doc Type** and another one for **Product Name**.</span></span> <span data-ttu-id="76f91-127">Para cada conjunto de términos, creamos un término para cada valor.</span><span class="sxs-lookup"><span data-stu-id="76f91-127">For each term set, we create a term for each value.</span></span> <span data-ttu-id="76f91-128">Tendría un aspecto similar a este en el Almacén de términos de su organización de SharePoint:</span><span class="sxs-lookup"><span data-stu-id="76f91-128">It would look like something like this in Term store for your SharePoint organization:</span></span>

![Conjunto de términos de la documentación del producto en el almacén de términos](media/SPRetention2.png)

<span data-ttu-id="76f91-130">El tipo de contenido se puede crear y publicar con el [Concentrador de tipo de contenido](https://support.office.com/article/manage-content-type-publishing-06f39ac0-5576-4b68-abbc-82b68334889b).</span><span class="sxs-lookup"><span data-stu-id="76f91-130">Content Type can be created and published using the [Content Type Hub](https://support.office.com/article/manage-content-type-publishing-06f39ac0-5576-4b68-abbc-82b68334889b).</span></span> <span data-ttu-id="76f91-131">Un tipo de contenido también se puede crear y publicar con herramientas de aprovisionamiento de sitios, como el [Marco de aprovisionamiento PnP](https://docs.microsoft.com/sharepoint/dev/solution-guidance/pnp-provisioning-framework) o el [Esquema JSON de diseño de sitio](https://docs.microsoft.com/sharepoint/dev/declarative-customization/site-design-json-schema#define-a-new-content-type).</span><span class="sxs-lookup"><span data-stu-id="76f91-131">A content type can also be created and published using site provisioning tools such as the [PnP provisioning framework](https://docs.microsoft.com/sharepoint/dev/solution-guidance/pnp-provisioning-framework) or the [site design JSON schema](https://docs.microsoft.com/sharepoint/dev/declarative-customization/site-design-json-schema#define-a-new-content-type).</span></span>

<span data-ttu-id="76f91-132">Cada producto tiene un sitio de SharePoint Online dedicado que contiene una biblioteca de documentos con los tipos de contenido adecuados habilitados.</span><span class="sxs-lookup"><span data-stu-id="76f91-132">Each product has a dedicated SharePoint Online site that contains one document library, with the right content types enabled.</span></span> <span data-ttu-id="76f91-133">Todos los documentos se almacenan en esta biblioteca de documentos.</span><span class="sxs-lookup"><span data-stu-id="76f91-133">All page layouts and master pages are stored in this document library.</span></span>

![Documentación de la biblioteca de documentos para productos](media/SPRetention3.png)

> [!NOTE]
> <span data-ttu-id="76f91-135">En lugar de tener un sitio de SharePoint Online por producto, en este escenario, la empresa manufacturera podría usar un equipo de Microsoft Teams por producto, que permitiría la colaboración con los miembros del equipo, como con el chat persistente y el uso de la pestaña **Archivos** del equipo para la administración de documentos.</span><span class="sxs-lookup"><span data-stu-id="76f91-135">Instead of having a SharePoint Online site per product, the manufacturing company in this scenario could use a Microsoft Team per product that would support collaboration with members of the team, such as persistent chat and use the **Files** tab in the team for document management.</span></span> <span data-ttu-id="76f91-136">En este artículo nos centraremos solo en los documentos, por lo que solo usaremos un sitio.</span><span class="sxs-lookup"><span data-stu-id="76f91-136">In this article we only focus on documents, therefore we will only use a site.</span></span>

<span data-ttu-id="76f91-137">La siguiente es una vista de la biblioteca de documentos para el producto Spinning Widget:</span><span class="sxs-lookup"><span data-stu-id="76f91-137">Here's a view of the document library for the Spinning Widget product:</span></span>

![Biblioteca de documentos de Spinning Widget](media/SPRetention4.png)

<span data-ttu-id="76f91-139">Ahora que tenemos la arquitectura de información básica para la administración de documentos, echemos un vistazo a la estrategia de retención y disposición de los documentos que usan los metadatos y la clasificación de documentos.</span><span class="sxs-lookup"><span data-stu-id="76f91-139">Now that we have the basic information architecture in place for document management, let's look at the retention and disposal strategy of the documents that use the metadata and classification of documents.</span></span>

## <a name="retention-and-disposition"></a><span data-ttu-id="76f91-140">Retención y disposición</span><span class="sxs-lookup"><span data-stu-id="76f91-140">Retention and disposition</span></span>

<span data-ttu-id="76f91-141">Las directivas de cumplimiento y gobierno de datos de la empresa manufacturera definen el modo en que se conservan y eliminan los datos.</span><span class="sxs-lookup"><span data-stu-id="76f91-141">The manufacturing company's compliance and data governance policies dictate the way data is preserved and disposed of.</span></span> <span data-ttu-id="76f91-142">Los documentos relacionados con el producto deben conservarse en todo momento durante la fabricación del producto y durante un período determinado tras la finalización de esta.</span><span class="sxs-lookup"><span data-stu-id="76f91-142">Product-related documents must be kept for as long as the product is manufactured, and for a certain period after that.</span></span> <span data-ttu-id="76f91-143">Este período es diferente para especificaciones del producto, acuerdos y manuales del usuario.</span><span class="sxs-lookup"><span data-stu-id="76f91-143">This period is different for product specifications, agreements, and user manuals.</span></span> <span data-ttu-id="76f91-144">En la tabla siguiente se indican los requisitos de retención y disposición:</span><span class="sxs-lookup"><span data-stu-id="76f91-144">The following table indicates the retention and disposition requirements:</span></span>

| <span data-ttu-id="76f91-145">**Tipo de documento**</span><span class="sxs-lookup"><span data-stu-id="76f91-145">**Document Type**</span></span>          | <span data-ttu-id="76f91-146">**Retención**</span><span class="sxs-lookup"><span data-stu-id="76f91-146">**Retention**</span></span>                          | <span data-ttu-id="76f91-147">**Disposición**</span><span class="sxs-lookup"><span data-stu-id="76f91-147">**Disposition**</span></span>                              |
| -------------------------- | -------------------------------------- | -------------------------------------------- |
| <span data-ttu-id="76f91-148">Especificaciones del producto</span><span class="sxs-lookup"><span data-stu-id="76f91-148">Product specification</span></span>      | <span data-ttu-id="76f91-149">5 años después del cese de producción.</span><span class="sxs-lookup"><span data-stu-id="76f91-149">5 years after cessation of production</span></span>  | <span data-ttu-id="76f91-150">Eliminar</span><span class="sxs-lookup"><span data-stu-id="76f91-150">Delete</span></span>                                       |
| <span data-ttu-id="76f91-151">Acuerdo de producto</span><span class="sxs-lookup"><span data-stu-id="76f91-151">Product agreement</span></span>          | <span data-ttu-id="76f91-152">10 años después del cese de producción.</span><span class="sxs-lookup"><span data-stu-id="76f91-152">10 years after cessation of production</span></span> | <span data-ttu-id="76f91-153">Revisar</span><span class="sxs-lookup"><span data-stu-id="76f91-153">Review</span></span>                                       |
| <span data-ttu-id="76f91-154">Manual de usuario</span><span class="sxs-lookup"><span data-stu-id="76f91-154">User manual</span></span>                | <span data-ttu-id="76f91-155">5 años después del cese de producción.</span><span class="sxs-lookup"><span data-stu-id="76f91-155">5 years after cessation of production</span></span>  | <span data-ttu-id="76f91-156">Eliminar</span><span class="sxs-lookup"><span data-stu-id="76f91-156">Delete</span></span>                                       |
| <span data-ttu-id="76f91-157">Cualquier otro tipo de documento</span><span class="sxs-lookup"><span data-stu-id="76f91-157">All other types of documents</span></span> | <span data-ttu-id="76f91-158">No conservar de forma activa otros documentos</span><span class="sxs-lookup"><span data-stu-id="76f91-158">Don't actively retain other documents</span></span>  | <span data-ttu-id="76f91-159">Eliminar cuando el documento tenga una antigüedad de más de 3 años<sup>\*</sup></span><span class="sxs-lookup"><span data-stu-id="76f91-159">Delete when document is older than 3 years<sup>\*</sup></span></span>  |
|||

> [!NOTE]
> <span data-ttu-id="76f91-160"><sup>\*</sup> Se considera que un documento tiene una antigüedad de más de 3 años si no se ha modificado en los últimos 3 años.</span><span class="sxs-lookup"><span data-stu-id="76f91-160"><sup>\*</sup> A document is considered older than 3 years if it hasn't been modified within the last 3 years.</span></span>

<span data-ttu-id="76f91-161">Con el centro de seguridad y cumplimiento, creamos las siguientes etiquetas de retención:</span><span class="sxs-lookup"><span data-stu-id="76f91-161">Using the security and compliance center, we create the following retention labels:</span></span>

  - <span data-ttu-id="76f91-162">Especificaciones del producto</span><span class="sxs-lookup"><span data-stu-id="76f91-162">Product Specification</span></span>

  - <span data-ttu-id="76f91-163">Acuerdo de producto</span><span class="sxs-lookup"><span data-stu-id="76f91-163">Product Agreement</span></span>

  - <span data-ttu-id="76f91-164">Manual de usuario</span><span class="sxs-lookup"><span data-stu-id="76f91-164">User manual</span></span>

<span data-ttu-id="76f91-165">En este artículo, solo se mostrará cómo crear y aplicar automáticamente la etiqueta de retención Especificaciones del producto.</span><span class="sxs-lookup"><span data-stu-id="76f91-165">In this article, we only show how to create and auto-apply the Product Specification retention label.</span></span> <span data-ttu-id="76f91-166">Para implementar el escenario completo, se crearían y aplicarían automáticamente las etiquetas de retención de los otros dos tipos de documentos.</span><span class="sxs-lookup"><span data-stu-id="76f91-166">To implement the complete scenario, you would create and auto-apply retention labels for the other two document types.</span></span>

### <a name="settings-for-the-product-specification-retention-label"></a><span data-ttu-id="76f91-167">Configuración de la etiqueta de retención Especificaciones del producto</span><span class="sxs-lookup"><span data-stu-id="76f91-167">Settings for the Product Specification retention label</span></span>

<span data-ttu-id="76f91-168">Este es el [plan de archivo](file-plan-manager.md) para la etiqueta de retención de Especificaciones del producto:</span><span class="sxs-lookup"><span data-stu-id="76f91-168">Here's the [file plan](file-plan-manager.md) for the Product Specification retention label:</span></span> 

- <span data-ttu-id="76f91-169">**Nombre:** Especificaciones del producto.</span><span class="sxs-lookup"><span data-stu-id="76f91-169">**Name:** Product Specification</span></span>

- <span data-ttu-id="76f91-170">**Descripción para administradores:** etiqueta de la especificación de producto, conservar durante 5 años después de la interrupción de la producción, la eliminación automática, la retención basada en eventos, el tipo de evento es la interrupción del producto.</span><span class="sxs-lookup"><span data-stu-id="76f91-170">**Description for admins:** Product Specification Label, retain for five years after cessation of production, auto delete, event-based retention, event type is Product Cessation.</span></span>

- <span data-ttu-id="76f91-171">**Descripción para los usuarios:** Conservar durante 5 años tras el cese de la producción.</span><span class="sxs-lookup"><span data-stu-id="76f91-171">**Description for users:** Retain for five years after cessation of production.</span></span>

- <span data-ttu-id="76f91-172">**Acción de retención:** conservar y eliminar.</span><span class="sxs-lookup"><span data-stu-id="76f91-172">**Retention action:** Keep and delete</span></span>

- <span data-ttu-id="76f91-173">**Duración de la retención:** Cinco años (1825 días).</span><span class="sxs-lookup"><span data-stu-id="76f91-173">**Retention duration:** Five years (1825 days)</span></span>

- <span data-ttu-id="76f91-174">**Etiqueta de registro**: configure la etiqueta de retención para clasificar el contenido como un [registro](labels.md#using-retention-labels-for-records-management) (los usuarios no pueden modificar ni eliminar los documentos que se clasifican como registros).</span><span class="sxs-lookup"><span data-stu-id="76f91-174">**Record label**: Configure the retention label to classify content as a [record](labels.md#using-retention-labels-for-records-management) (documents that are classified as a record can't be modified or deleted by users)</span></span>

- <span data-ttu-id="76f91-175">**Descriptores del plan de archivos:** (para simplificar el escenario, no se proporcionan descriptores de archivo).</span><span class="sxs-lookup"><span data-stu-id="76f91-175">**File plan descriptors:** (for simplifying the scenario, no file descriptors are provided)</span></span>

<span data-ttu-id="76f91-176">La siguiente captura de pantalla muestra la configuración al crear la [etiqueta de retención](labels.md) Especificaciones del producto en el centro de seguridad y cumplimiento.</span><span class="sxs-lookup"><span data-stu-id="76f91-176">The following screenshot shows the settings when you create the Product Specification [retention label](labels.md) in the security and compliance center.</span></span> <span data-ttu-id="76f91-177">Cuando cree la etiqueta de retención, puede crear el tipo de evento **Cese de producción**.</span><span class="sxs-lookup"><span data-stu-id="76f91-177">You can create the **Product Cessation** event type when you create the retention label.</span></span> <span data-ttu-id="76f91-178">Consulte los pasos que se muestran a continuación.</span><span class="sxs-lookup"><span data-stu-id="76f91-178">See the links below.</span></span>

![Configuración de retención para la etiqueta Especificaciones de producto](media/SPRetention5.png)

> [!NOTE]
> <span data-ttu-id="76f91-180">Por motivos prácticos y para evitar tener que esperar 5 años para ver como un documento se elimina automáticamente, configure la duración de la retención en 1 día si está recreando este escenario en el entorno de prueba.</span><span class="sxs-lookup"><span data-stu-id="76f91-180">For the practical purposes and to avoid having to wait 5 years to see a document automatically deleted, set the retention duration to 1 day if you're recreating this scenario in your test environment.</span></span>

### <a name="create-an-event-type-when-creating-a-retention-label"></a><span data-ttu-id="76f91-181">Creación de un tipo de evento al crear una etiqueta de retención</span><span class="sxs-lookup"><span data-stu-id="76f91-181">Create an event type when creating a retention label</span></span>

1. <span data-ttu-id="76f91-182">En la lista desplegable **Conservar o eliminar el contenido en función de**, seleccione **un evento**.</span><span class="sxs-lookup"><span data-stu-id="76f91-182">In the **Retain or delete content based** on dropdown list, select **an event**.</span></span>

2. <span data-ttu-id="76f91-183">Seleccione **Elegir tipo de evento**.</span><span class="sxs-lookup"><span data-stu-id="76f91-183">Select **Choose an event type**.</span></span>

   ![Crear un nuevo tipo de evento para la etiqueta de especificaciones del producto](media/SPRetention6.png)

3. <span data-ttu-id="76f91-185">En la página **Elegir tipo de evento**, seleccione **Puede crear nuevos tipos de eventos aquí**.</span><span class="sxs-lookup"><span data-stu-id="76f91-185">On the **Choose an event type** page, select **You can create new event types here**.</span></span>

4. <span data-ttu-id="76f91-186">Cree un tipo de evento denominado **Cese de producción**, añada una descripción y seleccione **Finalizar** para crearlo.</span><span class="sxs-lookup"><span data-stu-id="76f91-186">Create an event type named **Product Cessation**, give a description, and select **Finish** to create it.</span></span> 

5. <span data-ttu-id="76f91-187">Al volver a la página **Elegir un tipo de evento**, seleccione el tipo de evento **Cese de producción** que creó y seleccione **Agregar**.</span><span class="sxs-lookup"><span data-stu-id="76f91-187">Back on the **Choose an event type** page, select the **Product Cessation** event type that you created, and then select **Add**.</span></span>

<span data-ttu-id="76f91-188">Este es el aspecto que tiene la configuración de la etiqueta de retención de Especificaciones del producto.</span><span class="sxs-lookup"><span data-stu-id="76f91-188">Here's what the settings look like for the Product Specification retention label.</span></span> <span data-ttu-id="76f91-189">Seleccione **Crear esta etiqueta** para crearla.</span><span class="sxs-lookup"><span data-stu-id="76f91-189">Select **Create this label** to create it.</span></span>

![Configuración para la etiqueta nueva Especificaciones de producto](media/SPRetention7.png)

> [!TIP]
> <span data-ttu-id="76f91-191">Para obtener instrucciones más detalladas, consulte [Crear una etiqueta cuyo período de retención se base en un evento](event-driven-retention.md#step-1-create-a-label-whose-retention-period-is-based-on-an-event).</span><span class="sxs-lookup"><span data-stu-id="76f91-191">For more detailed steps, see [Create a label whose retention period is based on an event](event-driven-retention.md#step-1-create-a-label-whose-retention-period-is-based-on-an-event).</span></span>

<span data-ttu-id="76f91-192">Ahora que ha creado la etiqueta de retención, echemos un vistazo a la aplicación automática de la etiqueta de retención en el contenido de especificaciones del producto.</span><span class="sxs-lookup"><span data-stu-id="76f91-192">Now that the retention label is created, let's look at auto-applying the retention label to product specification content.</span></span>

## <a name="classifying-content-by-auto-applying-retention-labels"></a><span data-ttu-id="76f91-193">Clasificación del contenido con la aplicación automática de etiquetas de retención</span><span class="sxs-lookup"><span data-stu-id="76f91-193">Classifying content by auto-applying retention labels</span></span>

<span data-ttu-id="76f91-194">Vamos a [aplicar automáticamente](labels.md#applying-a-retention-label-automatically-based-on-conditions) las etiquetas de retención que hemos creado para este escenario mediante el lenguaje de consulta de palabras clave (KQL).</span><span class="sxs-lookup"><span data-stu-id="76f91-194">We're going to [auto-apply](labels.md#applying-a-retention-label-automatically-based-on-conditions) the retention labels that we've created for this scenario by using Keyword Query Language (KQL).</span></span> <span data-ttu-id="76f91-195">KQL es el lenguaje que se usa para crear consultas de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="76f91-195">KQL is the language used to build search queries.</span></span> <span data-ttu-id="76f91-196">En KQL, puede realizar búsquedas mediante palabras clave o propiedades administradas.</span><span class="sxs-lookup"><span data-stu-id="76f91-196">In KQL, you can search by using keywords or managed properties.</span></span> <span data-ttu-id="76f91-197">Para más información sobre KQL, consulte <https://docs.microsoft.com/sharepoint/dev/general-development/keyword-query-language-kql-syntax-reference>.</span><span class="sxs-lookup"><span data-stu-id="76f91-197">For more information about parameters, see <https://docs.microsoft.com/sharepoint/dev/general-development/keyword-query-language-kql-syntax-reference>.</span></span>

<span data-ttu-id="76f91-198">A nivel general, queremos indicar a Office 365 que "aplique la etiqueta de retención **Especificaciones del producto** a todos los documentos que contengan el **Estado** de \*\*Final \*\* y un **Tipo de documento** de **Especificaciones del producto**".</span><span class="sxs-lookup"><span data-stu-id="76f91-198">At a high level, we want to tell Office 365 to "apply the **Product Specification** retention label to all documents that have a **Status** of **Final** and a **Doc Type** of **Product Specification**.</span></span> <span data-ttu-id="76f91-199">Recuerde que **Estado** y **Tipo de documento** son las columnas de sitio que hemos definido anteriormente para el tipo de contenido Documentación del producto en la sección [Arquitectura de información](#information-architecture).</span><span class="sxs-lookup"><span data-stu-id="76f91-199">Recall that **Status** and **Doc Type** are the site columns we previously defined for Product Documentation content type in the [Information architecture](#information-architecture) section.</span></span> <span data-ttu-id="76f91-200">Para ello, debemos configurar el esquema de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="76f91-200">To achieve this, we need to configure the search schema.</span></span>

<span data-ttu-id="76f91-201">Cuando SharePoint indexa contenido, genera automáticamente propiedades rastreadas para cada columna de sitio.</span><span class="sxs-lookup"><span data-stu-id="76f91-201">When SharePoint indexes content, it automatically generates crawled properties for each site column.</span></span> <span data-ttu-id="76f91-202">Para este escenario, nos interesan las propiedades **Tipo de documento** y **Estado**.</span><span class="sxs-lookup"><span data-stu-id="76f91-202">For this scenario, we're interested in the **Doc Type** and **Status** properties.</span></span> <span data-ttu-id="76f91-203">Necesitamos documentos en la biblioteca con el tipo de contenido correcto y las columnas de sitio rellenadas, para que la búsqueda pueda crear las propiedades rastreadas.</span><span class="sxs-lookup"><span data-stu-id="76f91-203">We need documents in the library using the right content type and have the site columns filled in, in order for search to create the crawled properties.</span></span>

<span data-ttu-id="76f91-204">En el Centro de administración de SharePoint, podemos abrir la configuración de búsqueda y seleccionar **Administrar el esquema de búsqueda** para ver y configurar las propiedades rastreadas.</span><span class="sxs-lookup"><span data-stu-id="76f91-204">In the SharePoint admin center, we can open the Search configuration, and select **Manage Search Schema** to view and configure the crawled properties.</span></span>

![Propiedades rastreadas en el esquema de búsqueda](media/SPRetention8.png)

<span data-ttu-id="76f91-206">Si escribimos **estado** en el cuadro de **Propiedades rastreadas** y seleccionamos la flecha verde, deberíamos ver un resultado similar a este:</span><span class="sxs-lookup"><span data-stu-id="76f91-206">If we type **status** in the **Crawled properties** box, and select the green arrow, we should see a result like this:</span></span>

![La propiedad ows_Status rastreada](media/SPRetention9.png)

<span data-ttu-id="76f91-208">La propiedad **ows\_\_Status** (con doble guión bajo) es la que nos interesa.</span><span class="sxs-lookup"><span data-stu-id="76f91-208">The property **ows\_\_Status** (notice the double underscore) is the one that interests us.</span></span> <span data-ttu-id="76f91-209">Esta se asigna a la propiedad **Estado** del tipo de contenido del Documento de producción.</span><span class="sxs-lookup"><span data-stu-id="76f91-209">This maps to the **Status** property of the Production Document content type.</span></span>

<span data-ttu-id="76f91-210">Ahora, si escribimos **ows\_doc** y seleccionamos la flecha verde, deberíamos ver algo así:</span><span class="sxs-lookup"><span data-stu-id="76f91-210">Now if we type **ows\_doc** and select the green arrow we should see something like this:</span></span>

![La propiedad ows_Doc_Type rastreada](media/SPRetention10.png)

<span data-ttu-id="76f91-212">La propiedad **ows\_Doc\_x0020\_Type** es la segunda propiedad que nos interesa.</span><span class="sxs-lookup"><span data-stu-id="76f91-212">The property **ows\_Doc\_x0020\_Type** is the second property that interests us.</span></span> <span data-ttu-id="76f91-213">Se asigna a la propiedad **Tipo de documento** del tipo de contenido Documento de producción.</span><span class="sxs-lookup"><span data-stu-id="76f91-213">This maps to the **Doc Type** property of the Production Document content type.</span></span>

> [!TIP]
> <span data-ttu-id="76f91-214">Para identificar el nombre de una propiedad rastreada para este escenario, abra la biblioteca de documentos que contiene los documentos de producción y vaya a la configuración de la biblioteca.</span><span class="sxs-lookup"><span data-stu-id="76f91-214">To identify the name of a crawled property for this scenario, go the document library that contains the production documents and then go to the library settings.</span></span> <span data-ttu-id="76f91-215">En las **Columnas**, seleccione el nombre de la columna (por ejemplo, **Estado** o **Tipo de documento**) para abrir la página de columnas del sitio.</span><span class="sxs-lookup"><span data-stu-id="76f91-215">In the **Columns**, select the name of the column (for example, **Status** or **Doc Type**) to open the site column page.</span></span> <span data-ttu-id="76f91-216">El parámetro **Campo** en la dirección URL de la página contiene el nombre del campo.</span><span class="sxs-lookup"><span data-stu-id="76f91-216">The **Field** parameter in the URL for that page contains the name of the field.</span></span> <span data-ttu-id="76f91-217">El nombre de este campo, con el prefijo "ows_", es el nombre de la propiedad rastreada.</span><span class="sxs-lookup"><span data-stu-id="76f91-217">This field name, prefixed with "ows_", is the name of the crawled property.</span></span> <span data-ttu-id="76f91-218">Por ejemplo, la dirección URL `https://tenantname.sharepoint.com/sites/SpinningWidget/_layouts/15/FldEdit.aspx?List=%7BC38C2F45-3BD6-4C3B-AA3B-EF5DF6B3D172%7D&Field=_Status` corresponde a la propiedad rastreada **ows\_\_Status**.</span><span class="sxs-lookup"><span data-stu-id="76f91-218">For example, the URL `https://tenantname.sharepoint.com/sites/SpinningWidget/_layouts/15/FldEdit.aspx?List=%7BC38C2F45-3BD6-4C3B-AA3B-EF5DF6B3D172%7D&Field=_Status` corresponds to the **ows\_\_Status** crawled property.</span></span>

<span data-ttu-id="76f91-219">Si las propiedades rastreadas que está buscando no aparecen en la sección Administrar esquema de búsqueda en el centro de administración de SharePoint, puede deberse a uno de los siguientes motivos:</span><span class="sxs-lookup"><span data-stu-id="76f91-219">If the crawled properties you're looking for don't appear in the Manage Search Schema section in the SharePoint admin center, it could be for one of the following reasons:</span></span>

- <span data-ttu-id="76f91-220">Los documentos no se han indexado.</span><span class="sxs-lookup"><span data-stu-id="76f91-220">The documents haven't been indexed.</span></span> <span data-ttu-id="76f91-221">Puede forzar que se repita la indexación de la biblioteca yendo a la configuración de la biblioteca de documentos > Configuración avanzada.</span><span class="sxs-lookup"><span data-stu-id="76f91-221">You can force a re-index of the library by going to Document library settings > Advanced Settings.</span></span>

- <span data-ttu-id="76f91-222">Si la biblioteca de documentos está en un sitio moderno, asegúrese de que el administrador de SharePoint también es un administrador de la colección de sitios.</span><span class="sxs-lookup"><span data-stu-id="76f91-222">If the document library is in a modern site, make sure that the SharePoint admin is also a site collection admin.</span></span>

<span data-ttu-id="76f91-223">Para obtener más información sobre las propiedades rastreadas y administradas, vea [Crear automáticamente propiedades administradas en SharePoint Server](https://docs.microsoft.com/sharepoint/technical-reference/automatically-created-managed-properties-in-sharepoint).</span><span class="sxs-lookup"><span data-stu-id="76f91-223">For more information, see [Automatically created managed properties in SharePoint Server](https://docs.microsoft.com/sharepoint/technical-reference/automatically-created-managed-properties-in-sharepoint).</span></span>

### <a name="mapping-crawled-properties-to-pre-defined-managed-properties"></a><span data-ttu-id="76f91-224">Asignación de propiedades rastreadas a propiedades administradas previamente definidas</span><span class="sxs-lookup"><span data-stu-id="76f91-224">Mapping crawled properties to pre-defined managed properties</span></span>

<span data-ttu-id="76f91-225">KQL no puede usar propiedades rastreadas en las consultas de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="76f91-225">KQL can't use crawled properties in search queries.</span></span> <span data-ttu-id="76f91-226">Necesita usar una propiedad administrada.</span><span class="sxs-lookup"><span data-stu-id="76f91-226">It has to use a managed property.</span></span> <span data-ttu-id="76f91-227">En un escenario de búsqueda normal, creamos una propiedad administrada y la asignamos a la propiedad rastreada que necesitamos.</span><span class="sxs-lookup"><span data-stu-id="76f91-227">In a normal search scenario, we create a managed property and map it to the crawled property that we need.</span></span> <span data-ttu-id="76f91-228">Sin embargo, para aplicar las etiquetas de retención automáticamente, solo se pueden especificar en KQL las propiedades administradas predefinidas y no las propiedades administradas personalizadas.</span><span class="sxs-lookup"><span data-stu-id="76f91-228">However, for auto-applying retention labels, you can only specify in KQL pre-defined managed properties and not custom managed properties.</span></span> <span data-ttu-id="76f91-229">Se puede usar un conjunto de propiedades administradas predefinidas ya creadas en el sistema para las cadenas de RefinableString00 a RefinableString199.</span><span class="sxs-lookup"><span data-stu-id="76f91-229">There's a set of predefined managed properties already created in the system for string RefinableString00 to RefinableString199 that can be used.</span></span> <span data-ttu-id="76f91-230">Para obtener una lista completa, vea [Propiedades administradas sin usar predeterminadas](https://docs.microsoft.com/sharepoint/manage-search-schema#default-unused-managed-properties).</span><span class="sxs-lookup"><span data-stu-id="76f91-230">For a complete list, see [Default unused managed properties](https://docs.microsoft.com/sharepoint/manage-search-schema#default-unused-managed-properties).</span></span> <span data-ttu-id="76f91-231">Estas propiedades administradas predeterminadas suelen usarse para definir refinadores de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="76f91-231">These default managed properties are typically used for defining search refiners.</span></span>

<span data-ttu-id="76f91-232">Para que la consulta KQL funcione y aplique automáticamente la etiqueta de retención correcta en el contenido de documentos del producto, asignamos las propiedades rastreadas **ows\_Doc\_x0020\_Type** y **ows\_\_Status** a dos propiedades administradas que se pueden refinar.</span><span class="sxs-lookup"><span data-stu-id="76f91-232">For the KQL query to work and automatically apply the correct retention label to product document content, we map the crawled properties **ows\_Doc\_x0020\_Type** and **ows\_\_Status** to two refinable managed properties.</span></span> <span data-ttu-id="76f91-233">En nuestro entorno de prueba para este escenario, no se usan **RefinableString00** ni **RefinableString01**.</span><span class="sxs-lookup"><span data-stu-id="76f91-233">In our test environment for this scenario, **RefinableString00** and **RefinableString01** aren't being used.</span></span> <span data-ttu-id="76f91-234">La hemos determinado al analizar las **Propiedades administradas** en **Administrar esquema de búsqueda** en el centro de administración de SharePont.</span><span class="sxs-lookup"><span data-stu-id="76f91-234">We determined this by looking at **Managed Properties** in the **Manage Search Schema** in the SharePont admin center.</span></span>

![Propiedades administradas en el esquema de búsqueda](media/SPRetention12.png)

<span data-ttu-id="76f91-236">Observe que la columna **Propiedades rastreadas asignadas** en la captura de pantalla anterior está vacía.</span><span class="sxs-lookup"><span data-stu-id="76f91-236">Notice that the **Mapped Crawled Properties** column in the previous screenshot is empty.</span></span>

<span data-ttu-id="76f91-237">Para asignar la propiedad rastreada **ows\_Doc\_x0020\_Type**, siga estos pasos:</span><span class="sxs-lookup"><span data-stu-id="76f91-237">To map the **ows\_Doc\_x0020\_Type** crawled property, do the following:</span></span>

1. <span data-ttu-id="76f91-238">En el cuadro de filtro **Propiedad administrada**, escriba **RefinableString00** y seleccione la flecha verde.</span><span class="sxs-lookup"><span data-stu-id="76f91-238">In the **Managed property** filter box, type **RefinableString00** and select the green arrow.</span></span>

2. <span data-ttu-id="76f91-239">En la lista de resultados, seleccione el vínculo **RefinableString00** y desplácese hacia abajo hasta la sección **Asignaciones a propiedades rastreadas**.</span><span class="sxs-lookup"><span data-stu-id="76f91-239">In the results list, select the **RefinableString00** link, and then scroll down to the **Mappings to crawled properties** section.</span></span>  

3. <span data-ttu-id="76f91-240">Seleccione **Agregar una asignación** y escriba **ows\_Doc\_x0020\_Type** en el cuadro **Buscar un nombre de propiedad rastreada** en la ventana **Selección de propiedades rastreadas**.</span><span class="sxs-lookup"><span data-stu-id="76f91-240">Select **Add a Mapping**, and then type **ows\_Doc\_x0020\_Type** in the **Search for a crawled property name** box in the **Crawled property selection** window.</span></span> <span data-ttu-id="76f91-241">Seleccione **Buscar**.</span><span class="sxs-lookup"><span data-stu-id="76f91-241">Select **Find**.</span></span>  

4. <span data-ttu-id="76f91-242">En la lista de resultados, seleccione **ows\_Doc\_x0020\_Type** y seleccione **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="76f91-242">In the results list, select **ows\_Doc\_x0020\_Type** and then select **OK**.</span></span>

   <span data-ttu-id="76f91-243">En la sección **Propiedades rastreadas asignadas**, verá algo parecido a esta captura de pantalla:</span><span class="sxs-lookup"><span data-stu-id="76f91-243">In the **Mapped Crawled Properties** section, you should see something similar to this screenshot:</span></span>

   ![Seleccione Agregar una asignación en la sección Propiedades rastreadas asignadas](media/SPRetention13.png)

5. <span data-ttu-id="76f91-245">Desplácese hasta la parte inferior de la página y seleccione **Aceptar** para guardar la asignación.</span><span class="sxs-lookup"><span data-stu-id="76f91-245">Scroll to the bottom of the page and select **OK** to save the mapping.</span></span>

<span data-ttu-id="76f91-246">Repita este mismo procedimiento para asignar RefinableString01 y ows\_\_Status.</span><span class="sxs-lookup"><span data-stu-id="76f91-246">Repeat this same procedure to map RefinableString01 and ows\_\_Status.</span></span>

<span data-ttu-id="76f91-247">Ahora debería haber dos propiedades administradas asignadas a las dos propiedades rastreadas:</span><span class="sxs-lookup"><span data-stu-id="76f91-247">Now you should have two managed properties mapped to the two crawled properties:</span></span>

![Las propiedades administradas se asignan ahora a las propiedades rastreadas.](media/SPRetention14.png)

<span data-ttu-id="76f91-249">Vamos a comprobar que todo esto está configurado correctamente mediante la ejecución de una búsqueda empresarial.</span><span class="sxs-lookup"><span data-stu-id="76f91-249">Let's verify that all this is set up correctly by running an enterprise search.</span></span> <span data-ttu-id="76f91-250">En un explorador, vaya a https://yourtenant.sharepoint.com/search.</span><span class="sxs-lookup"><span data-stu-id="76f91-250">In a web browser, go to https://yourtenant.sharepoint.com/search.</span></span> <span data-ttu-id="76f91-251">En el cuadro de búsqueda, escriba **RefinableString00:"Especificaciones del producto"** y presione Entrar.</span><span class="sxs-lookup"><span data-stu-id="76f91-251">In the search box, type **RefinableString00:"Product Specification"** and press enter.</span></span> <span data-ttu-id="76f91-252">Al hacerlo, se deberían devolver todos los documentos que tengan Especificaciones del producto como **Tipo de documento**.</span><span class="sxs-lookup"><span data-stu-id="76f91-252">This should return all documents that have Product Specification as **Doc Type**.</span></span>

<span data-ttu-id="76f91-253">Ahora, en el cuadro de búsqueda, escriba **RefinableString00:"Especificaciones del producto" Y RefinableString01:Final** y presione Entrar.</span><span class="sxs-lookup"><span data-stu-id="76f91-253">Now in the search box, type **RefinableString00:"Product Specification" AND RefinableString01:Final** and press enter.</span></span> <span data-ttu-id="76f91-254">Esta acción debería devolver todos los documentos que tengan Especificaciones del producto como **Tipo de documento** y **Final** como estado.</span><span class="sxs-lookup"><span data-stu-id="76f91-254">This should return all documents that have Product Specification as **Doc Type** and a Status of **Final**.</span></span>

### <a name="creating-the-auto-apply-label-policies"></a><span data-ttu-id="76f91-255">Creación de directivas de aplicación automática de etiquetas</span><span class="sxs-lookup"><span data-stu-id="76f91-255">Creating the auto-apply label policies</span></span>

<span data-ttu-id="76f91-256">Ahora que hemos comprobado que la consulta de KQL funciona correctamente, crearemos la directiva de etiqueta que usa una consulta de KQL para aplicar automáticamente la etiqueta de retención Especificaciones del producto en los documentos correspondientes.</span><span class="sxs-lookup"><span data-stu-id="76f91-256">Now that we verified that the KQL query is working correctly, let's create the label policy that uses a KQL query to auto-apply the Product Specification retention label to the appropriate documents.</span></span>

1. <span data-ttu-id="76f91-257">En el [centro de seguridad y cumplimiento](https://protection.office.com), vaya a **Clasificación** > **Etiquetas de retención** y seleccione **Aplicar automáticamente una etiqueta**.</span><span class="sxs-lookup"><span data-stu-id="76f91-257">In the [security and compliance center](https://protection.office.com), go to **Classification** > **Retention labels**, and then select **Auto-apply a label**.</span></span> 

   ![Seleccione Aplicar automáticamente una etiqueta en la página Etiquetas](media/SPRetention16.png)

2. <span data-ttu-id="76f91-259">En la página del asistente **Elija una etiqueta para aplicar automáticamente**, seleccione **Elija una etiqueta para aplicar automáticamente**.</span><span class="sxs-lookup"><span data-stu-id="76f91-259">On the **Choose a label to auto-apply** wizard page, select **Choose a label to auto-apply**.</span></span>

3. <span data-ttu-id="76f91-260">En la lista de etiquetas, seleccione **Especificaciones del producto**, seleccione **Agregar** y seleccione **Siguiente**.</span><span class="sxs-lookup"><span data-stu-id="76f91-260">In the list of labels, select **Product Specification**, select **Add**, and then select **Next**.</span></span>

4. <span data-ttu-id="76f91-261">Seleccione **Aplicar la etiqueta al contenido que tenga palabras o frases específicas** y, luego, **Siguiente**.</span><span class="sxs-lookup"><span data-stu-id="76f91-261">Select **Apply label to content that contains specific words or phrases, or properties**, and then select **Next**.</span></span>

   ![Seleccione Aplicar la etiqueta al contenido que tenga palabras, frases o propiedades específicas](media/SPRetention17.png)

   <span data-ttu-id="76f91-263">En el siguiente paso, proporcionará la misma consulta de búsqueda de KQL que hemos probado en la sección anterior.</span><span class="sxs-lookup"><span data-stu-id="76f91-263">In the next step, you will provide the same KQL search query that we tested in the previous section.</span></span> <span data-ttu-id="76f91-264">Como recordará, esta consulta devuelve todos los documentos de Especificaciones del producto que tienen el estado Final.</span><span class="sxs-lookup"><span data-stu-id="76f91-264">As you recall, this query returned all Product Specification documents that have a status of Final.</span></span> <span data-ttu-id="76f91-265">El resultado de usar esta misma consulta en la directiva de etiqueta significa que la etiqueta de retención de Especificaciones del producto se aplicará automáticamente a todos los documentos que coincidan con esta consulta de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="76f91-265">The result of using this same query in the label policy means that the Product Specification retention label will be automatically applied to all documents that match this search query.</span></span>

5. <span data-ttu-id="76f91-266">En el cuadro **Editor de consultas de palabras clave**, escriba **RefinableString00:"Especificaciones del producto" AND RefinableString01:Final** y seleccione **Siguiente**.</span><span class="sxs-lookup"><span data-stu-id="76f91-266">In the **Keyword query editor** box, type **RefinableString00:"Product Specification" AND RefinableString01:Final**, and then select **Next**.</span></span>

   ![Especificar la consulta en el cuadro editor de Consulta de palabras clave](media/SPRetention19.png)

6. <span data-ttu-id="76f91-268">Escriba un nombre (por ejemplo, **Aplicar automáticamente etiqueta de Especificaciones del producto**) y una descripción opcional para la directiva de etiqueta. Después, seleccione **Siguiente**.</span><span class="sxs-lookup"><span data-stu-id="76f91-268">Type a name (for example, **Auto apply Product Specification label**) and an optional description for the label policy, and then select **Next**.</span></span> 

7. <span data-ttu-id="76f91-269">En la página del asistente **Elegir ubicaciones**, seleccione las ubicaciones de contenido a las que desea aplicar la directiva.</span><span class="sxs-lookup"><span data-stu-id="76f91-269">On the **Choose locations** wizard page, you select the content locations that you want to apply the policy to.</span></span> <span data-ttu-id="76f91-270">Para este escenario solo aplicamos la directiva a las ubicaciones de SharePoint, ya que todos los documentos de producción se almacenan solo en las bibliotecas de documentos de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="76f91-270">For this scenario, we apply the policy only to SharePoint locations because all production documents are stored only in SharePoint document libraries.</span></span> <span data-ttu-id="76f91-271">Seleccione **Permitir elegir ubicaciones específicas**, desactive el estado de Correo electrónico de Exchange, Cuentas de OneDrive y Grupos de Office 365 y asegúrese de que el estado de Sitios de SharePoint está activado.</span><span class="sxs-lookup"><span data-stu-id="76f91-271">Select **Let me choose specific locations**, toggle the status for Exchange email, OneDrive accounts, and Office 365 groups to off and make sure the status for SharePoint sites is toggled on.</span></span> 

    ![Elegir sitios específicos a los que aplicar etiquetas automáticamente](media/SPRetentionSPlocations.png)

   > [!TIP]
   > <span data-ttu-id="76f91-273">En lugar de aplicar la directiva a todos los sitios de SharePoint, puede seleccionar **Elegir sitios** y agregar las direcciones URL de sitios específicos de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="76f91-273">Instead of applying the policy to all SharePoint sites, you can select **Choose sites** and add the URLs for specific SharePoint sites.</span></span>

8. <span data-ttu-id="76f91-274">Seleccione **Siguiente** para mostrar la página **Revisar la configuración**.</span><span class="sxs-lookup"><span data-stu-id="76f91-274">Select **Next** to display the **Review your settings** page.</span></span> 

    ![Configuración para aplicar automáticamente la etiqueta](media/SPRetention18.png)

9. <span data-ttu-id="76f91-276">Seleccione **Aplicar automáticamente** para crear la directiva de etiqueta.</span><span class="sxs-lookup"><span data-stu-id="76f91-276">Select **Auto-apply** to create the label policy.</span></span> <span data-ttu-id="76f91-277">Puede llevar hasta 7 días aplicar automáticamente la etiqueta de Especificaciones del producto a todos los documentos que coincidan con la consulta de búsqueda de KQL que ha proporcionado.</span><span class="sxs-lookup"><span data-stu-id="76f91-277">It takes up to seven days to automatically apply the Product Specification label to all documents that match the KQL search query that you provided.</span></span>

### <a name="verifying-the-retention-label-was-automatically-applied"></a><span data-ttu-id="76f91-278">Comprobación de que la etiqueta de retención se aplicó automáticamente</span><span class="sxs-lookup"><span data-stu-id="76f91-278">Verifying the retention label was automatically applied</span></span>

<span data-ttu-id="76f91-279">Después de 7 días, utilice el [Explorador de actividad de etiquetas](view-label-activity-for-documents.md) en el centro de seguridad y cumplimiento para comprobar que la directiva de etiquetas que hemos creado ha aplicado automáticamente las etiquetas de retención a los documentos de producto en este escenario.</span><span class="sxs-lookup"><span data-stu-id="76f91-279">After seven days, use the [Label activity explorer](view-label-activity-for-documents.md) in the security and compliance center to see that the label policy that we created has automatically applied the retention labels in this scenario to the product documents.</span></span> <span data-ttu-id="76f91-280">En la siguiente captura de pantalla, las etiquetas de retención también se han aplicado a los contratos de producto y los manuales de usuario, aunque no se hayan tratado la creación de esas directivas de etiqueta y etiquetas de retención en este artículo.</span><span class="sxs-lookup"><span data-stu-id="76f91-280">In the following screenshot, retention labels have also been applied to product agreements and user manuals, even though we didn't cover creating those retention labels and label policies in this article.</span></span>

![Use el explorador de actividad de etiquetas para comprobar que la etiqueta se aplicó automáticamente.](media/SPRetention20.png)

<span data-ttu-id="76f91-282">Otro paso de la comprobación es revisar las propiedades del documento en la biblioteca de documentos.</span><span class="sxs-lookup"><span data-stu-id="76f91-282">Another verification step is to look at the properties of the document in the Document Library.</span></span> <span data-ttu-id="76f91-283">En el panel de información, puede ver que la etiqueta de retención se ha aplicado a un documento seleccionado.</span><span class="sxs-lookup"><span data-stu-id="76f91-283">In the information panel, you can see that the retention label is applied to a selected document.</span></span>

![Compruebe que la etiqueta se aplicó. Para ello, observe las propiedades del documento en la Biblioteca de documentos](media/SPRetention21.png)

<span data-ttu-id="76f91-285">Puesto que las etiquetas de retención se han aplicado automáticamente a los documentos, los documentos no se pueden eliminar porque la etiqueta de retención se configuró para declarar los documentos como registros.</span><span class="sxs-lookup"><span data-stu-id="76f91-285">Because the retention labels have been auto-applied to documents, the documents are protected from being deleted because the retention label was configured to declare the documents as records.</span></span> <span data-ttu-id="76f91-286">Por ejemplo, recibimos el mensaje de error que se muestra en la siguiente captura de pantalla al intentar eliminar uno de estos documentos.</span><span class="sxs-lookup"><span data-stu-id="76f91-286">As an example of this protection, we receive an error message shown in the following screenshot when we try to delete one of these documents.</span></span>

![No se pueden eliminar documentos porque la etiqueta declara registros de documentos](media/SPRetention22.png)

## <a name="generating-the-events-that-trigger-the-start-of-the-retention-period"></a><span data-ttu-id="76f91-288">Generación de los eventos que desencadenan el inicio del periodo de retención</span><span class="sxs-lookup"><span data-stu-id="76f91-288">Generating the events that trigger the start of the retention period</span></span>

<span data-ttu-id="76f91-289">Ahora que las etiquetas de retención se aplicaron correctamente y de forma automática, pasemos al evento que indicará el final de producción para un producto en particular.</span><span class="sxs-lookup"><span data-stu-id="76f91-289">Now that the retention labels were successfully automatically applied, let's focus on the event that will indicate the end of production for a particular product.</span></span> <span data-ttu-id="76f91-290">Cuando se produce este evento, desencadena el inicio del periodo de retención definido en la etiqueta de retención aplicada automáticamente a los documentos.</span><span class="sxs-lookup"><span data-stu-id="76f91-290">When this event occurs, it triggers the beginning of the retention period defined in retention labels auto-applied to documents.</span></span> <span data-ttu-id="76f91-291">Por ejemplo, para los documentos de especificaciones del producto, el período de retención de cinco años comienza cuando se activa el evento "fin de producción".</span><span class="sxs-lookup"><span data-stu-id="76f91-291">For example, for product specification documents, the five-year retention period begins when the "end of production" event is triggered.</span></span>

<span data-ttu-id="76f91-292">Puede crear el evento manualmente en el Centro de seguridad y cumplimiento. Para ello, vaya a **Administración de registros** > **Eventos**, elija el tipo de evento, configure los Id. de activo adecuados y escriba la fecha del evento.</span><span class="sxs-lookup"><span data-stu-id="76f91-292">You can manually create the event in the security and compliance center by going to **Records Managements** > **Events** and choosing the event type, setting the correct Asset Ids, and entering a date for the event.</span></span> <span data-ttu-id="76f91-293">Para obtener más información, consulte [Información general sobre la retención basada en eventos](event-driven-retention.md).</span><span class="sxs-lookup"><span data-stu-id="76f91-293">For more information about this method, see [Overview of event-driven retention](event-driven-retention.md).</span></span>

<span data-ttu-id="76f91-294">Para este escenario, se creará automáticamente el evento al generarlo desde un sistema de producción externo.</span><span class="sxs-lookup"><span data-stu-id="76f91-294">For this scenario, we'll automatically create the event by generating it from an external production system.</span></span> <span data-ttu-id="76f91-295">En este caso, el sistema que genera el evento es una lista simple de SharePoint que indica si un producto está en producción y un [Microsoft Flow](https://docs.microsoft.com/flow/getting-started) que está asociado con la lista y que activará el evento.</span><span class="sxs-lookup"><span data-stu-id="76f91-295">In this case, the system that generates the event is a simple SharePoint list that indicates whether a product is in production and a [Microsoft Flow](https://docs.microsoft.com/flow/getting-started) that's associated with the list and will trigger the event.</span></span> <span data-ttu-id="76f91-296">En un escenario real, cualquier sistema podría generar el evento, como un sistema de RRHH o CRM.</span><span class="sxs-lookup"><span data-stu-id="76f91-296">In a real-world scenario, it could be any system that generates the event, such as an HR or CRM system.</span></span> <span data-ttu-id="76f91-297">Flow contiene muchas interacciones listas para usarse y un bloque de creación para cargas de trabajo de Office 365 (como Exchange, SharePoint, Teams y Dynamics 365), así como para aplicaciones de terceros como Twitter, Box, Salesforce y Workdays.</span><span class="sxs-lookup"><span data-stu-id="76f91-297">Flow contains many ready-to-use interactions and building block for Office 365 workloads such as Exchange, SharePoint, Teams, and Dynamics 365, and third-party apps such as Twitter, Box, Salesforce, and Workdays.</span></span> <span data-ttu-id="76f91-298">Esto hace que sea más fácil integrar Flow en estos sistemas.</span><span class="sxs-lookup"><span data-stu-id="76f91-298">This makes it easy to integrate Flow with these systems.</span></span> <span data-ttu-id="76f91-299">Para obtener más información, consulte [Retención automática controlada por eventos](automate-event-driven-retention.md).</span><span class="sxs-lookup"><span data-stu-id="76f91-299">For more information about this method, see [Overview of event-driven retention](automate-event-driven-retention.md).</span></span>

<span data-ttu-id="76f91-300">La siguiente captura de pantalla muestra la lista de SharePoint que se usará para desencadenar el evento:</span><span class="sxs-lookup"><span data-stu-id="76f91-300">The following screenshot shows the SharePoint list that will be used the trigger the event:</span></span> 

![Lista que se usará para desencadenar eventos de retención](media/SPRetention23.png)

<span data-ttu-id="76f91-302">Hay dos productos actualmente en producción, indicados por el valor de **Sí** en la columna **En producción**.</span><span class="sxs-lookup"><span data-stu-id="76f91-302">There are two products currently in production, which is indicated by the value of **Yes** in the **In Production** column.</span></span> <span data-ttu-id="76f91-303">Cuando el valor de esta columna se establezca en **No** para un producto, el flujo asociado con la lista generará automáticamente el evento.</span><span class="sxs-lookup"><span data-stu-id="76f91-303">When the value in this column is set to **No** for a product, the flow associated with the list will automatically generate the event.</span></span> <span data-ttu-id="76f91-304">Este proceso provoca, a su vez, el inicio del periodo de retención de la etiqueta de retención que se aplicó automáticamente a los documentos de producto correspondientes.</span><span class="sxs-lookup"><span data-stu-id="76f91-304">This in turn triggers the start of the retention period for the retention label that was auto-applied to the corresponding product documents.</span></span>

<span data-ttu-id="76f91-305">En este escenario, usamos el flujo siguiente para desencadenar el evento:</span><span class="sxs-lookup"><span data-stu-id="76f91-305">For this scenario, we use the following flow to trigger the event:</span></span>

![Configuración del flujo que activará el evento](media/SPRetention24.png)

<span data-ttu-id="76f91-307">Para crear este flujo, parta de un conector de SharePoint y seleccione el desencadenador **Cuando se crea o modifica un elemento**.</span><span class="sxs-lookup"><span data-stu-id="76f91-307">To create this flow, start from a SharePoint connector and select the **When an item is created or modified** trigger.</span></span> <span data-ttu-id="76f91-308">Especifique la dirección del sitio y el nombre de la lista y agregue una condición basada en que el valor de la columna de lista **En producción** se establezca en **No** (o que sea igual a falso en la tarjeta condicional).</span><span class="sxs-lookup"><span data-stu-id="76f91-308">Specify the site address and list name, and then add a condition based on when the **In Production** list column value is set to **No** (or equal to false in the condition card).</span></span> <span data-ttu-id="76f91-309">Después, agregue una acción basada en la plantilla HTTP integrada.</span><span class="sxs-lookup"><span data-stu-id="76f91-309">Then add an action based on the built-in HTTP template.</span></span> <span data-ttu-id="76f91-310">Use los valores de la tabla siguiente para configurar la acción HTTP.</span><span class="sxs-lookup"><span data-stu-id="76f91-310">Use the values in the following table to configure the HTTP action.</span></span> <span data-ttu-id="76f91-311">Puede copiar los valores de las propiedades URI y Cuerpo de la tabla siguiente y pegarlos en la plantilla.</span><span class="sxs-lookup"><span data-stu-id="76f91-311">You can copy the values for the URI and Body properties from the table below and then paste them into the template.</span></span>

<table>
<thead>
<tr class="header">
<th><span data-ttu-id="76f91-312"><strong>Parámetro</strong></span><span class="sxs-lookup"><span data-stu-id="76f91-312"><strong>Parameter</strong></span></span></th>
<th><span data-ttu-id="76f91-313"><strong>Valor</strong></span><span class="sxs-lookup"><span data-stu-id="76f91-313"><strong>Value</strong></span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="76f91-314">Método</span><span class="sxs-lookup"><span data-stu-id="76f91-314">Method</span></span></td>
<td><span data-ttu-id="76f91-315">PUBLICAR</span><span class="sxs-lookup"><span data-stu-id="76f91-315">POST</span></span></td>
<tr class="even">
<td><span data-ttu-id="76f91-316">URI</span><span class="sxs-lookup"><span data-stu-id="76f91-316">URI</span></span></td>
<td><a href="https://ps.compliance.protection.outlook.com/psws/service.svc/ComplianceRetentionEvent">https://ps.compliance.protection.outlook.com/psws/service.svc/ComplianceRetentionEvent</a></td>
<td></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="76f91-317">Encabezados</span><span class="sxs-lookup"><span data-stu-id="76f91-317">Headers</span></span></td>
<td><span data-ttu-id="76f91-318">Clave = Content-Type, valor = application/atom+xml</span><span class="sxs-lookup"><span data-stu-id="76f91-318">Key = Content-Type, Value = application/atom+xml</span></span></td>
<td></td>
</tr>
<tr class="even">
<td><span data-ttu-id="76f91-319">Cuerpo</span><span class="sxs-lookup"><span data-stu-id="76f91-319">Body</span></span></td>
<td><p><span data-ttu-id="76f91-320">&lt;?xml version='1.0' encoding='utf-8' standalone='yes'?&gt;</span><span class="sxs-lookup"><span data-stu-id="76f91-320">&lt;?xml version='1.0' encoding='utf-8' standalone='yes'?&gt;</span></span></p>
<p><span data-ttu-id="76f91-321">&lt;entry xmlns:d='https://schemas.microsoft.com/ado/2007/08/dataservices' xmlns:m='https://schemas.microsoft.com/ado/2007/08/dataservices/metadata' xmlns='https://www.w3.org/2005/Atom'&gt;</span><span class="sxs-lookup"><span data-stu-id="76f91-321">&lt;entry xmlns:d='https://schemas.microsoft.com/ado/2007/08/dataservices' xmlns:m='https://schemas.microsoft.com/ado/2007/08/dataservices/metadata' xmlns='https://www.w3.org/2005/Atom'&gt;</span></span></p>
<p><span data-ttu-id="76f91-322">&lt;category scheme='https://schemas.microsoft.com/ado/2007/08/dataservices/scheme' term='Exchange.ComplianceRetentionEvent' /&gt;</span><span class="sxs-lookup"><span data-stu-id="76f91-322">&lt;category scheme='https://schemas.microsoft.com/ado/2007/08/dataservices/scheme' term='Exchange.ComplianceRetentionEvent' /&gt;</span></span></p>
<p><span data-ttu-id="76f91-323">&lt;updated&gt;9/9/2017 10:50:00 PM&lt;/updated&gt;</span><span class="sxs-lookup"><span data-stu-id="76f91-323">&lt;updated&gt;9/9/2017 10:50:00 PM&lt;/updated&gt;</span></span></p>
<p><span data-ttu-id="76f91-324">&lt;content type='application/xml'&gt;</span><span class="sxs-lookup"><span data-stu-id="76f91-324">&lt;content type='application/xml'&gt;</span></span></p>
<p><span data-ttu-id="76f91-325">&lt;m:properties&gt;</span><span class="sxs-lookup"><span data-stu-id="76f91-325">&lt;m:properties&gt;</span></span></p>
<p><span data-ttu-id="76f91-326">&lt;d:Name&gt;Cese de producción @{triggerBody()?['Product_x0020_Name']?['Value']}&lt;/d:Name&gt;</span><span class="sxs-lookup"><span data-stu-id="76f91-326">&lt;d:Name&gt;Cessation Production @{triggerBody()?['Product_x0020_Name']?['Value']}&lt;/d:Name&gt;</span></span></p>
<p><span data-ttu-id="76f91-327">&lt;d:EventType&gt;Cese de producción&lt;/d:EventType&gt;</span><span class="sxs-lookup"><span data-stu-id="76f91-327">&lt;d:EventType&gt;Product Cessation&lt;/d:EventType&gt;</span></span></p>
<p><span data-ttu-id="76f91-328">&lt;d:SharePointAssetIdQuery&gt;ProductName:&quot;@{triggerBody()?['Product_x0020_Name']?['Value']}&quot;&lt;/d:SharePointAssetIdQuery&gt;</span><span class="sxs-lookup"><span data-stu-id="76f91-328">&lt;d:SharePointAssetIdQuery&gt;ProductName:&quot;@{triggerBody()?['Product_x0020_Name']?['Value']}&quot;&lt;/d:SharePointAssetIdQuery&gt;</span></span></p>
<p><span data-ttu-id="76f91-329">&lt;d:EventDateTime&gt;@{formatDateTime(utcNow(),'yyyy-MM-dd')}&lt;/d:EventDateTime&gt;</span><span class="sxs-lookup"><span data-stu-id="76f91-329">&lt;d:EventDateTime&gt;@{formatDateTime(utcNow(),'yyyy-MM-dd')}&lt;/d:EventDateTime&gt;</span></span></p>
<p><span data-ttu-id="76f91-330">&lt;/m:properties&gt;</span><span class="sxs-lookup"><span data-stu-id="76f91-330">&lt;/m:properties&gt;</span></span></p>
<p><span data-ttu-id="76f91-331">&lt;/content&gt;</span><span class="sxs-lookup"><span data-stu-id="76f91-331">&lt;/content&gt;</span></span></p>
<p><span data-ttu-id="76f91-332">&lt;/entry&gt;</span><span class="sxs-lookup"><span data-stu-id="76f91-332">&lt;/entry&gt;</span></span></p></td>
<td></td>
</tr>

</tbody>
</table>

<span data-ttu-id="76f91-333">En la tabla siguiente se describen los parámetros de la propiedad Body de la acción que se deben configurar específicamente para este escenario.</span><span class="sxs-lookup"><span data-stu-id="76f91-333">The following table describes the parameters within the Body property of the action that must be configured specifically for this scenario.</span></span> 

<table>
<thead>
<tr class="header">
<th><span data-ttu-id="76f91-334"><strong>Parámetro</strong></span><span class="sxs-lookup"><span data-stu-id="76f91-334"><strong>Parameter</strong></span></span></th>
<th><span data-ttu-id="76f91-335"><strong>Descripción</strong></span><span class="sxs-lookup"><span data-stu-id="76f91-335"><strong>Description</strong></span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="76f91-336">Nombre</span><span class="sxs-lookup"><span data-stu-id="76f91-336">Name</span></span></td>
<td><span data-ttu-id="76f91-337">Este parámetro especifica el nombre del evento que se creará en el centro de seguridad y cumplimiento.</span><span class="sxs-lookup"><span data-stu-id="76f91-337">This parameter specifies the name of the event that will be created in the security and compliance center.</span></span> <span data-ttu-id="76f91-338">Para este escenario, el nombre es "Cese de producción xxx", donde xxx es el valor de la propiedad administrada NombreProducto que hemos creado anteriormente.</span><span class="sxs-lookup"><span data-stu-id="76f91-338">For this scenario, the name is "Cessation Production xxx", where xxx is the value of the ProductName managed property that we created earlier.</span></span> </th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span data-ttu-id="76f91-339">EventType</span><span class="sxs-lookup"><span data-stu-id="76f91-339">EventType</span></span></td>
<td><span data-ttu-id="76f91-340">El valor de este parámetro corresponde al tipo de evento al que se aplicará el evento creado.</span><span class="sxs-lookup"><span data-stu-id="76f91-340">The value for this parameter corresponds to the event type that the created event will apply to.</span></span> <span data-ttu-id="76f91-341">Este tipo de evento se definió al crear la etiqueta de retención.</span><span class="sxs-lookup"><span data-stu-id="76f91-341">This event type was defined when you created the retention label.</span></span> <span data-ttu-id="76f91-342">Para este escenario, el tipo de evento es "Cese de producción".</span><span class="sxs-lookup"><span data-stu-id="76f91-342">For this scenario, the event type is "Product Cessation".</span></span></td>
</tr>
<tr class="even">
<td><span data-ttu-id="76f91-343">SharePointAssetIdQuery</span><span class="sxs-lookup"><span data-stu-id="76f91-343">SharePointAssetIdQuery</span></span></td>
<td><span data-ttu-id="76f91-344">Este parámetro define el Id. de activo del evento.</span><span class="sxs-lookup"><span data-stu-id="76f91-344">This parameter defines the Asset Id for the event.</span></span> <span data-ttu-id="76f91-345">La retención basada en eventos necesita un identificador único para el documento.</span><span class="sxs-lookup"><span data-stu-id="76f91-345">Event-based retention needs a unique identifier for the document.</span></span> <span data-ttu-id="76f91-346">Podemos usar Id. de activos para identificar los documentos a los que se aplica un evento determinado, o bien, como se hace para este escenario, una columna de metadatos, nuestro Nombre del producto.</span><span class="sxs-lookup"><span data-stu-id="76f91-346">We can use Asset Ids to identify the documents that a particular event applies to, or as we do for this scenario, a metadata column, our own Product Name.</span></span> <span data-ttu-id="76f91-347">Para ello, debemos crear una nueva propiedad administrada llamada NombreProducto que pueda usarse en la consulta KQL (también podíamos haber usado RefinableString00 en lugar de crear una nueva propiedad administrada).</span><span class="sxs-lookup"><span data-stu-id="76f91-347">To do  this, we have to create a new managed property named ProductName that can be used in the KQL query (or we could have used RefinableString00 instead of creating a new managed property).</span></span> <span data-ttu-id="76f91-348">También necesitamos asignar esta nueva propiedad administrada a la propiedad rastreada ows_Product_x0020_Name.</span><span class="sxs-lookup"><span data-stu-id="76f91-348">We also need to map this new managed property to the ows_Product_x0020_Name crawled property.</span></span> <span data-ttu-id="76f91-349">Esta es una captura de pantalla de esta propiedad administrada.</span><span class="sxs-lookup"><span data-stu-id="76f91-349">Here's a screenshot of this managed property.</span></span>

<img src="media/SPRetention25.png" style="width:6.49722in;height:0.45069in" /></td>
</tr>
<tr class="odd">
<td><span data-ttu-id="76f91-350">EventDateTime</span><span class="sxs-lookup"><span data-stu-id="76f91-350">eventDateTime</span></span></td>
<td><span data-ttu-id="76f91-351">Este parámetro define la fecha en la que se produce el evento.</span><span class="sxs-lookup"><span data-stu-id="76f91-351">This parameter defines the date the event occurs.</span></span> <span data-ttu-id="76f91-352">Use el formato de fecha actual: <strong>formatDateTime(utcNow(),'aaaa-MM-dd'<strong>)</strong></span><span class="sxs-lookup"><span data-stu-id="76f91-352">Use the current date format: <strong>formatDateTime(utcNow(),'yyyy-MM-dd'<strong>)</strong></span></span></td>
</tr>
</tbody>
</table>

### <a name="putting-it-all-together"></a><span data-ttu-id="76f91-353">En conclusión</span><span class="sxs-lookup"><span data-stu-id="76f91-353">Putting it all together</span></span>

<span data-ttu-id="76f91-354">Ahora que la etiqueta de retención se ha creado y aplicado automáticamente, y que el flujo se creado y configurado, esto es lo que ocurre cuando el valor de la columna **En producción** para el producto Spinning Widget en la lista productos se cambia de **Sí** a **No**.</span><span class="sxs-lookup"><span data-stu-id="76f91-354">Now that the retention label is created and auto-applied and the flow is configured and created, here's what happens when the value in the **In Production** column for the Spinning Widget product in the Products list is changed from **Yes** to **No**.</span></span> <span data-ttu-id="76f91-355">El flujo se activa y crea el evento.</span><span class="sxs-lookup"><span data-stu-id="76f91-355">The flow is triggered and creates the event.</span></span> <span data-ttu-id="76f91-356">Para ver este evento en el Centro de seguridad y cumplimiento, vaya a **Administración de registros** > **Eventos**.</span><span class="sxs-lookup"><span data-stu-id="76f91-356">To see this event in the security and compliance center, go to **Records management** > **Events**.</span></span>

![Evento activado por el flujo que se muestra en la página Eventos en el Centro de seguridad y cumplimiento](media/SPRetention28.png)

<span data-ttu-id="76f91-358">Seleccione el evento para ver los detalles en la página de control flotante.</span><span class="sxs-lookup"><span data-stu-id="76f91-358">Select the event to view the details on the flyout page.</span></span> <span data-ttu-id="76f91-359">Observe que, aunque se ha creado el evento, los detalles del estado del evento muestran que no se han procesado documentos o sitios de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="76f91-359">Notice that even though the event is created, the details in the event status show that no SharePoint sites or documents have been processed.</span></span>

![Detalles del evento](media/SPRetention29.png)

<span data-ttu-id="76f91-361">Pero, después de un tiempo, la sección de estado del evento muestra que se han procesado un sitio de SharePoint y un documento de SharePoint.</span><span class="sxs-lookup"><span data-stu-id="76f91-361">But after some time, the event status section shows that for a SharePoint site and a SharePoint document have been processed.</span></span>  

![Los Detalles del evento muestran que los documentos se han procesado](media/SPRetention31.png)
 
<span data-ttu-id="76f91-363">Esto significa que se ha iniciado el período de retención de la etiqueta aplicada al documento de producto de Spinning Widget, en base a la fecha del evento Cese de producción de Spinning Widget.</span><span class="sxs-lookup"><span data-stu-id="76f91-363">This means the retention period for the label applied to the Spinning Widget product document has been initiated, based on the event date of the Cessation Production Spinning Widget event.</span></span> <span data-ttu-id="76f91-364">Suponiendo que ha implementado el escenario en el entorno de prueba configurando un período de retención de un día, puede ir a la biblioteca de documentos de los documentos de su producto unos días después de crear el evento y comprobar que el documento se haya eliminado (después de que se haya ejecutado la eliminación de la tarea en SharePoint).</span><span class="sxs-lookup"><span data-stu-id="76f91-364">Assuming you implemented the scenario in your test environment by configuring a one-day retention period, you can go to the document library for your product documents a few days after the event was created and verify that the document is deleted (after the deletion job in SharePoint has run).</span></span>

### <a name="more-about-asset-ids"></a><span data-ttu-id="76f91-365">Más información sobre los Id. de activo</span><span class="sxs-lookup"><span data-stu-id="76f91-365">More about Asset Ids</span></span>

<span data-ttu-id="76f91-366">Como se explica en la [Información general sobre la retención controlada por eventos](event-driven-retention.md), es importante entender la relación entre los tipos de eventos, las etiquetas, los eventos y los Id. de activos.</span><span class="sxs-lookup"><span data-stu-id="76f91-366">As explained in the [overview of event-driven retention](event-driven-retention.md), it's important to understand the relationship between event types, labels, events, and asset Ids.</span></span> <span data-ttu-id="76f91-367">El Id. de activo es simplemente otra propiedad de documento en SharePoint y OneDrive.</span><span class="sxs-lookup"><span data-stu-id="76f91-367">The Asset Id is simply another document property in SharePoint and OneDrive.</span></span> <span data-ttu-id="76f91-368">Le ayuda a identificar con mayor detalle los documentos cuyo período de retención se desencadenará con el evento.</span><span class="sxs-lookup"><span data-stu-id="76f91-368">It helps you to further identify the documents whose retention period will be triggered by the event.</span></span> <span data-ttu-id="76f91-369">De forma predeterminada, SharePoint tiene una propiedad Id. de activo que puede usar para la retención basada en eventos:</span><span class="sxs-lookup"><span data-stu-id="76f91-369">By default, SharePoint has an Asset Id property that you can use for event-driven retention:</span></span>

![Puede encontrar la propiedad ID. de activo en la página de detalles de las propiedades del documento](media/SPRetention26.png)

<span data-ttu-id="76f91-371">Como se muestra en la siguiente captura de pantalla, la propiedad administrada Id. de activo se denomina **ComplianceAssetId**.</span><span class="sxs-lookup"><span data-stu-id="76f91-371">As shown in the following screenshot, the Asset Id managed property is called **ComplianceAssetId**.</span></span>

![Propiedad administrada ComplianceAssetId ](media/SPRetention27.png)

<span data-ttu-id="76f91-373">En lugar de usar la propiedad Id. de activo predeterminada, también puede usar otras propiedades, como hacemos en este escenario.</span><span class="sxs-lookup"><span data-stu-id="76f91-373">Instead of using the default Asset Id property, you can also use any other property, as we do in this scenario.</span></span> <span data-ttu-id="76f91-374">No obstante, es importante comprender que, si no especifica palabras clave o un Id. de activo para un evento, el evento desencadenará el período de retención de todo el contenido que tenga aplicada una etiqueta de ese tipo de evento.</span><span class="sxs-lookup"><span data-stu-id="76f91-374">It's important to understand that if you don't specify an asset ID or keywords for an event, all of the content with a label of that event type will have its retention period triggered by the event. This means that in the diagram above, all of the content would start being retained. This may not be what you intend.</span></span>

### <a name="using-advanced-search-in-sharepoint"></a><span data-ttu-id="76f91-375">Uso de la búsqueda avanzada en SharePoint</span><span class="sxs-lookup"><span data-stu-id="76f91-375">Using advanced search in SharePoint</span></span>

<span data-ttu-id="76f91-376">En la captura de pantalla anterior, también podemos ver que existe otra propiedad administrada relacionada con las etiquetas de retención denominada **ComplianceTag**, que se asigna a una propiedad rastreada.</span><span class="sxs-lookup"><span data-stu-id="76f91-376">In the previous screenshot, we can also see that there's another managed property related to retention labels called **ComplianceTag** and that it's mapped to a crawled property.</span></span> <span data-ttu-id="76f91-377">La propiedad administrada **ComplianceAssetId** también se asigna a una propiedad rastreada.</span><span class="sxs-lookup"><span data-stu-id="76f91-377">The managed property to which a crawled property is mapped.</span></span> <span data-ttu-id="76f91-378">Esto significa que puede usar estas propiedades administradas en la búsqueda avanzada para recuperar todos los documentos que se han etiquetado con una etiqueta de retención.</span><span class="sxs-lookup"><span data-stu-id="76f91-378">This means you can use these managed properties in advanced search to retrieve all documents that have been tagged with a retention label.</span></span>

## <a name="summary"></a><span data-ttu-id="76f91-379">Resumen</span><span class="sxs-lookup"><span data-stu-id="76f91-379">Summary</span></span>

<span data-ttu-id="76f91-380">Este artículo muestra un escenario de administración de documentos donde aplicamos automáticamente una etiqueta de retención basada en una columna de sitio en SharePoint.</span><span class="sxs-lookup"><span data-stu-id="76f91-380">This article illustrated a document management scenario where we automatically applied a retention label based on a site column in SharePoint.</span></span> <span data-ttu-id="76f91-381">Después, se utiliza la retención basada en eventos y Microsoft Flow para activar automáticamente el inicio del periodo de retención en función de un evento externo.</span><span class="sxs-lookup"><span data-stu-id="76f91-381">Then we used event-based retention and Microsoft Flow to automatically trigger the start of the retention period based on an external event.</span></span>

## <a name="credits"></a><span data-ttu-id="76f91-382">Créditos</span><span class="sxs-lookup"><span data-stu-id="76f91-382">Credits</span></span>

<span data-ttu-id="76f91-383">Este escenario lo creó:</span><span class="sxs-lookup"><span data-stu-id="76f91-383">This scenario was authored by:</span></span>

<span data-ttu-id="76f91-384">Frederic Lapierre</span><span class="sxs-lookup"><span data-stu-id="76f91-384">Frederic Lapierre</span></span><br/><span data-ttu-id="76f91-385">Consultor principal de Microsoft Services</span><span class="sxs-lookup"><span data-stu-id="76f91-385">Craig Schwandt, Principal Consultant, Microsoft Consulting Services</span></span>
