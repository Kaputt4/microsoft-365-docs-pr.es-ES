---
title: Usar reglas de flujo de correo para bloquear mensajes con datos adjuntos ejecutables
f1.keywords:
- NOCSH
ms.author: chrisda
author: chrisda
manager: dansimp
ms.date: ''
audience: ITPro
ms.topic: how-to
ms.service: O365-seccomp
localization_priority: Normal
ms.assetid: c4fb4a86-b772-49d0-8773-e8ee897e175d
ms.custom:
- seo-marvel-apr2020
description: Los administradores pueden aprender a crear reglas de flujo de correo (reglas de transporte) para bloquear mensajes que contengan datos adjuntos ejecutables.
ms.openlocfilehash: b78fd282e6b5a7f20d1dab830da296e4be4ac812
ms.sourcegitcommit: e12fa502bc216f6083ef5666f693a04bb727d4df
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/20/2020
ms.locfileid: "46827658"
---
# <a name="use-mail-flow-rules-to-block-messages-with-executable-attachments-in-eop"></a>Usar reglas de flujo de correo para bloquear mensajes con datos adjuntos ejecutables en EOP

En Microsoft 365 organizaciones con buzones de correo en Exchange online o en organizaciones independientes de Exchange Online Protection (EOP) sin buzones de Exchange Online, EOP usa directivas antimalware para bloquear mensajes dañinos, incluidos los mensajes con datos adjuntos ejecutables. Para obtener más información, vea [protección contra malware en EOP](anti-malware-protection.md).

Para mejorar aún más la protección, puede usar reglas de flujo de correo (también conocidas como reglas de transporte) para identificar y bloquear mensajes que contengan datos adjuntos ejecutables, como se describe en este tema.

Por ejemplo, tras un brote de malware, una compañía podría aplicar esta regla con un límite de tiempo para que los usuarios afectados puedan volver a enviar datos adjuntos después de un período de tiempo especificado.

## <a name="what-do-you-need-to-know-before-you-begin"></a>¿Qué necesita saber antes de empezar?

- Debe tener permisos asignados para poder realizar estos procedimientos:

  - En Exchange Online, consulte el entrada "flujo de correo" en [Feature Permissions in Exchange Online](https://docs.microsoft.com/Exchange/permissions-exo/feature-permissions).
  
  - En EOP independiente, necesita el rol reglas de transporte, que se asigna a los roles OrganizationManagement, ComplianceManagement y RecordsManagement de forma predeterminada. Para obtener más información, vea [permisos en EOP independiente](feature-permissions-in-eop.md) y [usar el EAC para modificar la lista de miembros de los grupos de roles](manage-admin-role-group-permissions-in-eop.md#use-the-eac-modify-the-list-of-members-in-role-groups).

- Para abrir el EAC en Exchange Online, consulte [centro de administración de Exchange en Exchange Online](https://docs.microsoft.com/Exchange/exchange-admin-center). Para abrir el EAC en un EOP independiente, consulte [centro de administración de Exchange en EOP independiente](exchange-admin-center-in-exchange-online-protection-eop.md).

- Para conectarse al PowerShell de Exchange Online, consulte [Conexión a Exchange Online PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell). Para conectarse a EOP PowerShell independiente, consulte [Connect to Exchange Online Protection PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-protection-powershell) (Conexión a Exchange Online Protection PowerShell).

- Para obtener más información acerca de las reglas de flujo de correo en Exchange Online y EOP independiente, consulte los siguientes temas:

  - [Reglas de flujo de correo (reglas de transporte) en Exchange Online](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rules)

  - [Excepciones (predicados) y condiciones de reglas de flujo de correo en Exchange Online](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/conditions-and-exceptions)

  - [Acciones de las reglas de flujo de correo en Exchange Online](https://docs.microsoft.com/Exchange/security-and-compliance/mail-flow-rules/mail-flow-rule-actions)

## <a name="use-the-eac-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a>Usar el EAC para crear una regla que bloquee mensajes con datos adjuntos ejecutables

1. En el EAC, vaya a **Flujo de correo** \> **Reglas**.

2. Haga clic en **Agregar** ![ icono Agregar ](../../media/ITPro-EAC-AddIcon.png) y, a continuación, seleccione **crear una nueva regla**.

3. En la ventana **Nueva regla** que se abre, configure las siguientes opciones:

   - **Name**: escriba un nombre único y descriptivo para la regla.

   - Haga clic en **Más opciones**.

   - **Aplicar esta regla si**: seleccione **cualquier archivo adjunto** \> **con contenido ejecutable**.

   - **Haga lo siguiente**: seleccione **bloquear el mensaje** y, a continuación, elija la acción que desee:

     - **rechazar el mensaje e incluir una explicación**: en el cuadro de diálogo **especificar motivo de rechazo** que aparece, escriba el texto que desea que aparezca en el informe de no entrega (también conocido como un mensaje NDR o de devolución). El código de estado mejorado que se usa es 5.7.1.

     - **rechazar el mensaje con el código de estado mejorado de**: en el cuadro de diálogo **escribir código de estado mejorado** que aparece, escriba el código de estado mejorado que desea que aparezca en el NDR. Los valores válidos son 5.7.1 o un valor de 5.7.900 a 5.7.999. El texto de rechazo predeterminado es: entrega no autorizada, mensaje rechazado.

     - **rechazar el mensaje sin notificar a nadie**

4. Cuando haya terminado, haga clic en **Guardar**. La regla de bloqueo de datos adjuntos ya está en vigor.

## <a name="use-powershell-to-create-a-rule-that-blocks-messages-with-executable-attachments"></a>Usar PowerShell para crear una regla que bloquee mensajes con datos adjuntos ejecutables

Use la siguiente sintaxis para crear una regla que bloquee los mensajes que contengan datos adjuntos ejecutables:

```powershell
New-TransportRule -Name "<UniqueName>" -AttachmentHasExecutableContent $true [-RejectMessageEnhancedStatusCode <5.7.1 | 5.7.900 to 5.7.999>] [-RejectMessageReasonText "<Text>"] [-DeleteMessage $true]
```

**Notas**:

- Si usa el parámetro _RejectMessageEnhancedStatusCode_ sin el parámetro _RejectMessageReasonText_ , el texto predeterminado es: no se autoriza la entrega, se rechazará el mensaje.

- Si usa el parámetro _RejectMessageReasonText_ sin el parámetro _RejectMessageEnhancedStatusCode_ , el código predeterminado es 5.7.1.

En este ejemplo, se crea una regla nueva denominada bloquear datos adjuntos ejecutables que eliminan silenciosamente mensajes que contienen datos adjuntos ejecutables.

```powershell
New-TransportRule -Name "Block Executable Attachments" -AttachmentHasExecutableContent $true -DeleteMessage $true
```

Para obtener información detallada acerca de la sintaxis y los parámetros, vea [New-TransportRule](https://docs.microsoft.com/powershell/module/exchange/new-transportrule).

## <a name="how-do-you-know-this-worked"></a>¿Cómo saber si el proceso se completó correctamente?

Para comprobar que ha creado correctamente una regla de flujo de correo para bloquear los mensajes que contienen datos adjuntos ejecutables, siga uno de estos pasos:

- En el EAC, vaya a reglas de **flujo de correo** \> **Rules** \> Seleccione la regla \> haga clic en **Editar** ![ icono ](../../media/ITPro-EAC-EditIcon.png) de edición y Compruebe la configuración.

- En PowerShell, ejecute el siguiente comando para comprobar la configuración:

  ```powershell
  Get-TransportRule -Identity "<Rule Name>" | Format-List Name,AttachmentHasExecutableContent,RejectMessage*,DeleteMessage
  ```
