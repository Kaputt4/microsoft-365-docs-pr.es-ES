---
title: Detectar y corregir los ataques de las reglas de Outlook y de las inyecciones de formularios personalizados.
f1.keywords:
- NOCSH
ms.author: tracyp
author: MSFTTracyp
manager: dansimp
ms.date: 04/23/2018
audience: ITPro
ms.topic: article
ms.collection:
- o365_security_incident_response
- M365-security-compliance
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
description: Obtenga información sobre cómo reconocer y corregir los ataques de las reglas de Outlook y de las inyecciones de formularios personalizados en Office 365
ms.custom: seo-marvel-apr2020
ms.openlocfilehash: cbdc41315d64d341248d6900147aabc5a0b9877c
ms.sourcegitcommit: 47de4402174c263ae8d70c910ca068a7581d04ae
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 12/12/2020
ms.locfileid: "49663648"
---
# <a name="detect-and-remediate-outlook-rules-and-custom-forms-injections-attacks"></a><span data-ttu-id="31b08-103">Detectar y corregir ataques de las reglas de Outlook y de las inyecciones de formularios personalizados</span><span class="sxs-lookup"><span data-stu-id="31b08-103">Detect and Remediate Outlook Rules and Custom Forms Injections Attacks</span></span>

[!INCLUDE [Microsoft 365 Defender rebranding](../includes/microsoft-defender-for-office.md)]


<span data-ttu-id="31b08-104">**Resumen** Obtenga información sobre cómo reconocer y corregir los ataques de las reglas de Outlook y de las inyecciones de formularios personalizados en Office 365.</span><span class="sxs-lookup"><span data-stu-id="31b08-104">**Summary** Learn how to recognize and remediate the Outlook rules and custom Forms injections attacks in Office 365.</span></span>

## <a name="what-is-the-outlook-rules-and-custom-forms-injection-attack"></a><span data-ttu-id="31b08-105">¿Qué es el ataque de inserción de formularios personalizados y reglas de Outlook?</span><span class="sxs-lookup"><span data-stu-id="31b08-105">What is the Outlook Rules and Custom Forms injection attack?</span></span>

<span data-ttu-id="31b08-106">Una vez que un atacante ha incumplido una cuenta en su arrendamiento y se incluye en, hay que probar y establecer una forma de seguir adelante o una forma de volver a ella una vez que se han descubierto y eliminado.</span><span class="sxs-lookup"><span data-stu-id="31b08-106">After an attacker has breached an account in your tenancy and gets in, they're are going to try and establish a way to stay in or a way to get back in after they are discovered and removed.</span></span> <span data-ttu-id="31b08-107">Esto se denomina establecer un mecanismo de persistencia.</span><span class="sxs-lookup"><span data-stu-id="31b08-107">This is called establishing a persistence mechanism.</span></span> <span data-ttu-id="31b08-108">Dos formas de hacerlo es aprovechando las reglas de Outlook o inyectando formularios personalizados en Outlook.</span><span class="sxs-lookup"><span data-stu-id="31b08-108">Two ways that they can do this are by exploiting Outlook rules or by injecting custom forms into Outlook.</span></span>
<span data-ttu-id="31b08-109">En ambos casos, la regla o el formulario se sincronizan desde el servicio de nube hacia el cliente de escritorio, por lo que un formato completo y la reinstalación del software cliente no eliminan el mecanismo de inserción.</span><span class="sxs-lookup"><span data-stu-id="31b08-109">In both cases, the rule or form is synced from the cloud service down to the desktop client, so a full format and re-install of the client software doesn't eliminate the injection mechanism.</span></span> <span data-ttu-id="31b08-110">Esto se debe a que, al volver a conectar el software de cliente de Outlook al buzón de la nube, se volverán a descargar las reglas y los formularios de la nube.</span><span class="sxs-lookup"><span data-stu-id="31b08-110">This is because when the Outlook client software reconnects to the mailbox in the cloud it will re-download the rules and forms from the cloud.</span></span> <span data-ttu-id="31b08-111">Una vez que las reglas y los formularios están en su ubicación, el atacante los usa para ejecutar código remoto o personalizado, normalmente para instalar malware en el equipo local.</span><span class="sxs-lookup"><span data-stu-id="31b08-111">Once the rules and forms are in place, the attacker uses them to execute remote or custom code, usually to install malware on the local machine.</span></span> <span data-ttu-id="31b08-112">A continuación, el malware vuelve a robar credenciales o realiza otras actividades ilícitas.</span><span class="sxs-lookup"><span data-stu-id="31b08-112">The malware then re-steals credentials or performs other illicit activity.</span></span>
<span data-ttu-id="31b08-113">La buena noticia es que si mantiene los clientes revisados a la versión más reciente, no es vulnerable a la amenaza como los valores predeterminados del cliente de Outlook actual bloquean ambos mecanismos.</span><span class="sxs-lookup"><span data-stu-id="31b08-113">The good news here is that if you keep your clients patched to the latest version, you are not vulnerable to the threat as current Outlook client defaults block both mechanisms.</span></span>

<span data-ttu-id="31b08-114">Normalmente, los ataques siguen estos patrones:</span><span class="sxs-lookup"><span data-stu-id="31b08-114">The attacks typically follow these patterns:</span></span>

<span data-ttu-id="31b08-115">**El ataque de reglas**:</span><span class="sxs-lookup"><span data-stu-id="31b08-115">**The Rules Exploit**:</span></span>

1. <span data-ttu-id="31b08-116">El atacante roba el nombre de usuario y la contraseña de uno de los usuarios.</span><span class="sxs-lookup"><span data-stu-id="31b08-116">The attacker steals the username and password of one of your users.</span></span>

2. <span data-ttu-id="31b08-117">A continuación, el atacante inicia sesión en el buzón de correo de Exchange de los usuarios.</span><span class="sxs-lookup"><span data-stu-id="31b08-117">The attacker then signs in to that users Exchange mailbox.</span></span> <span data-ttu-id="31b08-118">El buzón puede estar en Exchange online o en Exchange local.</span><span class="sxs-lookup"><span data-stu-id="31b08-118">The mailbox can either be in Exchange online or in Exchange on-premises.</span></span>

3. <span data-ttu-id="31b08-119">A continuación, el atacante crea una regla de reenvío en el buzón que se desencadena cuando el buzón recibe un correo electrónico que coincide con los criterios de la regla.</span><span class="sxs-lookup"><span data-stu-id="31b08-119">The attacker then creates a forwarding rule in the mailbox that is triggered when the mailbox receives an email that matches the criteria of the rule.</span></span> <span data-ttu-id="31b08-120">Los criterios de regla y el contenido del correo electrónico del desencadenador se realizan de una a otra.</span><span class="sxs-lookup"><span data-stu-id="31b08-120">The criteria of rule and the contents of the trigger email are tailor-made for each other.</span></span>

4. <span data-ttu-id="31b08-121">El atacante envía el mensaje de correo electrónico del desencadenador al usuario que está usando su buzón normalmente.</span><span class="sxs-lookup"><span data-stu-id="31b08-121">The attacker sends the trigger email to the user who is using their mailbox normally.</span></span>

5. <span data-ttu-id="31b08-122">Cuando se recibe el correo electrónico, se activa la regla.</span><span class="sxs-lookup"><span data-stu-id="31b08-122">When the email is received, the rule is triggered.</span></span> <span data-ttu-id="31b08-123">La acción de la regla suele ser iniciar una aplicación en un servidor remoto (WebDAV).</span><span class="sxs-lookup"><span data-stu-id="31b08-123">The action of the rule is usually to launch an application on a remote (WebDAV) server.</span></span>

6. <span data-ttu-id="31b08-124">Normalmente, la aplicación instala malware, como [PowerShell Empire](https://www.powershellempire.com/), de forma local en el equipo del usuario.</span><span class="sxs-lookup"><span data-stu-id="31b08-124">The application typically installs malware, such as [Powershell Empire](https://www.powershellempire.com/), locally on the user's machine.</span></span>

7. <span data-ttu-id="31b08-125">El malware permite al atacante volver a robar el nombre de usuario y la contraseña del usuario u otras credenciales del equipo local y realizar otras actividades malintencionadas.</span><span class="sxs-lookup"><span data-stu-id="31b08-125">The malware allows the attacker to re-steal the user's username and password or other credentials from local machine and perform other malicious activities.</span></span>

<span data-ttu-id="31b08-126">**La vulnerabilidad de los formularios**:</span><span class="sxs-lookup"><span data-stu-id="31b08-126">**The Forms Exploit**:</span></span>

1. <span data-ttu-id="31b08-127">El atacante roba el nombre de usuario y la contraseña de uno de los usuarios.</span><span class="sxs-lookup"><span data-stu-id="31b08-127">The attacker steals the username and password of one of your users.</span></span>

2. <span data-ttu-id="31b08-128">A continuación, el atacante inicia sesión en el buzón de correo de Exchange de los usuarios.</span><span class="sxs-lookup"><span data-stu-id="31b08-128">The attacker then sign in to that users Exchange mailbox.</span></span> <span data-ttu-id="31b08-129">El buzón puede estar en Exchange online o en Exchange local.</span><span class="sxs-lookup"><span data-stu-id="31b08-129">The mailbox can either be in Exchange online or in Exchange on-premises.</span></span>

3. <span data-ttu-id="31b08-130">A continuación, el atacante crea una plantilla de formulario de correo personalizada y la inserta en el buzón del usuario.</span><span class="sxs-lookup"><span data-stu-id="31b08-130">The attacker then creates a custom mail form template and inserts it into the user's mailbox.</span></span> <span data-ttu-id="31b08-131">El formulario personalizado se desencadena cuando el buzón recibe un correo electrónico que requiere que el buzón de correo cargue el formulario personalizado.</span><span class="sxs-lookup"><span data-stu-id="31b08-131">The custom form is triggered when the mailbox receives an email that requires the mailbox to load the custom form.</span></span> <span data-ttu-id="31b08-132">El formulario personalizado y el formato de correo electrónico se realizan de forma personalizada entre sí.</span><span class="sxs-lookup"><span data-stu-id="31b08-132">The custom form and the format of email are tailor-made for each other.</span></span>
4. <span data-ttu-id="31b08-133">El atacante envía el mensaje de correo electrónico del desencadenador al usuario, que usa el buzón normalmente.</span><span class="sxs-lookup"><span data-stu-id="31b08-133">The attacker sends the trigger email to the user, who is using their mailbox normally.</span></span>

5. <span data-ttu-id="31b08-134">Cuando se recibe el mensaje de correo electrónico, se carga el formulario.</span><span class="sxs-lookup"><span data-stu-id="31b08-134">When the email is received, the form is loaded.</span></span> <span data-ttu-id="31b08-135">El formulario inicia una aplicación en un servidor remoto (WebDAV).</span><span class="sxs-lookup"><span data-stu-id="31b08-135">The form launches an application on a remote (WebDAV) server.</span></span>

6. <span data-ttu-id="31b08-136">Normalmente, la aplicación instala malware, como [PowerShell Empire](https://www.powershellempire.com/), de forma local en el equipo del usuario.</span><span class="sxs-lookup"><span data-stu-id="31b08-136">The application typically installs malware, such as [Powershell Empire](https://www.powershellempire.com/), locally on the user's machine.</span></span>

7. <span data-ttu-id="31b08-137">El malware permite al atacante volver a robar el nombre de usuario y la contraseña del usuario u otras credenciales del equipo local y realizar otras actividades malintencionadas.</span><span class="sxs-lookup"><span data-stu-id="31b08-137">The malware allows the attacker to re-steal the user's username and password or other credentials from local machine and perform other malicious activities.</span></span>

## <a name="what-a-rules-and-custom-forms-injection-attack-might-look-like-office-365"></a><span data-ttu-id="31b08-138">¿Qué puede parecer un ataque de inserción de reglas y formularios personalizados como Office 365?</span><span class="sxs-lookup"><span data-stu-id="31b08-138">What a Rules and Custom Forms Injection attack might look like Office 365?</span></span>

<span data-ttu-id="31b08-139">Es improbable que los usuarios detecten estos mecanismos de persistencia y, en algunos casos, incluso pueden ser invisibles para ellos.</span><span class="sxs-lookup"><span data-stu-id="31b08-139">These persistence mechanisms are unlikely to be noticed by your users and may in some cases even be invisible to them.</span></span> <span data-ttu-id="31b08-140">En este artículo se explica cómo buscar cualquiera de los siete signos (indicadores de peligro) que se enumeran a continuación.</span><span class="sxs-lookup"><span data-stu-id="31b08-140">This article tells you how to look for any of the seven signs (Indicators of Compromise) listed below.</span></span> <span data-ttu-id="31b08-141">Si encuentra alguno de estos, debe seguir los pasos de corrección.</span><span class="sxs-lookup"><span data-stu-id="31b08-141">If you find any of these, you need to take remediation steps.</span></span>

- <span data-ttu-id="31b08-142">Indicadores del compromiso de las reglas:</span><span class="sxs-lookup"><span data-stu-id="31b08-142">Indicators of the Rules compromise:</span></span>

  - <span data-ttu-id="31b08-143">La acción de regla es iniciar una aplicación.</span><span class="sxs-lookup"><span data-stu-id="31b08-143">Rule Action is to start an application.</span></span>

  - <span data-ttu-id="31b08-144">La regla hace referencia a un EXE, ZIP o dirección URL.</span><span class="sxs-lookup"><span data-stu-id="31b08-144">Rule References an EXE, ZIP, or URL.</span></span>

  - <span data-ttu-id="31b08-145">En el equipo local, busque inicios de proceso nuevos que se originen desde el PID de Outlook.</span><span class="sxs-lookup"><span data-stu-id="31b08-145">On the local machine, look for new process starts that originate from the Outlook PID.</span></span>

- <span data-ttu-id="31b08-146">Indicadores de los formularios personalizados que ponen en peligro:</span><span class="sxs-lookup"><span data-stu-id="31b08-146">Indicators of the Custom forms compromise:</span></span>

  - <span data-ttu-id="31b08-147">El formulario personalizado está guardado como su propia clase de mensaje.</span><span class="sxs-lookup"><span data-stu-id="31b08-147">Custom form present saved as their own message class.</span></span>

  - <span data-ttu-id="31b08-148">La clase de mensaje contiene código ejecutable.</span><span class="sxs-lookup"><span data-stu-id="31b08-148">Message class contains executable code.</span></span>

  - <span data-ttu-id="31b08-149">Suele almacenarse en la biblioteca de formularios personales o en las carpetas de la bandeja de entrada.</span><span class="sxs-lookup"><span data-stu-id="31b08-149">Usually stored in Personal Forms Library or Inbox folders.</span></span>

  - <span data-ttu-id="31b08-150">El formulario se denomina IPM. Note. [nombre personalizado].</span><span class="sxs-lookup"><span data-stu-id="31b08-150">Form is named IPM.Note.[custom name].</span></span>

## <a name="steps-for-finding-signs-of-this-attack-and-confirming-it"></a><span data-ttu-id="31b08-151">Pasos para buscar signos de este ataque y confirmarlo</span><span class="sxs-lookup"><span data-stu-id="31b08-151">Steps for finding signs of this attack and confirming it</span></span>

<span data-ttu-id="31b08-152">Puede usar cualquiera de estos dos métodos para confirmar el ataque:</span><span class="sxs-lookup"><span data-stu-id="31b08-152">You can use either of these two methods to confirm the attack:</span></span>

- <span data-ttu-id="31b08-153">Examine manualmente las reglas y los formularios de cada buzón de correo mediante el cliente de Outlook.</span><span class="sxs-lookup"><span data-stu-id="31b08-153">Manually examine the rules and forms for each mailbox using the Outlook client.</span></span> <span data-ttu-id="31b08-154">Este método es exhaustivo, pero solo puede consultar a un usuario de buzón de correo a la vez que puede llevar mucho tiempo si tiene que comprobar muchos usuarios.</span><span class="sxs-lookup"><span data-stu-id="31b08-154">This method is thorough, but you can only check mailbox user at a time which can be very time consuming if you have many users to check.</span></span> <span data-ttu-id="31b08-155">También puede provocar una infracción del equipo desde el que está ejecutando la comprobación.</span><span class="sxs-lookup"><span data-stu-id="31b08-155">It can also result in a breach of the computer that you are running the check from.</span></span>

- <span data-ttu-id="31b08-156">Use el script de PowerShell [Get-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) para volcar automáticamente todas las reglas de reenvío de correo y los formularios personalizados para todos los usuarios de su arrendamiento.</span><span class="sxs-lookup"><span data-stu-id="31b08-156">Use the [Get-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) PowerShell script to automatically dump all the mail forwarding rules and custom forms for all the users in your tenancy.</span></span> <span data-ttu-id="31b08-157">Este es el método más rápido y seguro con la menor cantidad de sobrecarga.</span><span class="sxs-lookup"><span data-stu-id="31b08-157">This is the fastest and safest method with the least amount of overhead.</span></span>

### <a name="confirm-the-rules-attack-using-the-outlook-client"></a><span data-ttu-id="31b08-158">Confirmar el ataque de reglas mediante el cliente de Outlook</span><span class="sxs-lookup"><span data-stu-id="31b08-158">Confirm the Rules Attack Using the Outlook client</span></span>

1. <span data-ttu-id="31b08-159">Abra el cliente de Outlook de los usuarios como usuario.</span><span class="sxs-lookup"><span data-stu-id="31b08-159">Open the users Outlook client as the user.</span></span> <span data-ttu-id="31b08-160">Es posible que el usuario necesite su ayuda para examinar las reglas de su buzón.</span><span class="sxs-lookup"><span data-stu-id="31b08-160">The user may need your help in examining the rules on their mailbox.</span></span>

2. <span data-ttu-id="31b08-161">Consulte [administrar mensajes de correo electrónico](https://support.microsoft.com/office/c24f5dea-9465-4df4-ad17-a50704d66c59) mediante el artículo de reglas para obtener los procedimientos sobre cómo abrir la interfaz de reglas en Outlook.</span><span class="sxs-lookup"><span data-stu-id="31b08-161">Refer to [Manage email messages by using rules](https://support.microsoft.com/office/c24f5dea-9465-4df4-ad17-a50704d66c59) article for the procedures on how to open the rules interface in Outlook.</span></span>

3. <span data-ttu-id="31b08-162">Busque las reglas que el usuario no ha creado o las reglas o reglas inesperadas con nombres sospechosos.</span><span class="sxs-lookup"><span data-stu-id="31b08-162">Look for rules that the user did not create, or any unexpected rules or rules with suspicious names.</span></span>

4. <span data-ttu-id="31b08-163">Busque en la descripción de la regla las acciones de regla que se inician y se aplicación o que hacen referencia a. EXE,. Archivo ZIP o para iniciar una dirección URL.</span><span class="sxs-lookup"><span data-stu-id="31b08-163">Look in the rule description for rule actions that start and application or refer to an .EXE, .ZIP file or to launching a URL.</span></span>

5. <span data-ttu-id="31b08-164">Busque los nuevos procesos que empiecen a usar el ID de proceso de Outlook.</span><span class="sxs-lookup"><span data-stu-id="31b08-164">Look for any new processes that start using the Outlook process ID.</span></span> <span data-ttu-id="31b08-165">Consulte [Buscar el identificador de proceso](https://docs.microsoft.com/windows-hardware/drivers/debugger/finding-the-process-id).</span><span class="sxs-lookup"><span data-stu-id="31b08-165">Refer to [Find the Process ID](https://docs.microsoft.com/windows-hardware/drivers/debugger/finding-the-process-id).</span></span>

### <a name="steps-to-confirm-the-forms-attack-using-the-outlook-client"></a><span data-ttu-id="31b08-166">Pasos para confirmar el ataque de formularios con el cliente de Outlook</span><span class="sxs-lookup"><span data-stu-id="31b08-166">Steps to confirm the Forms attack using the Outlook client</span></span>

1. <span data-ttu-id="31b08-167">Abra el cliente de Outlook de usuario como usuario.</span><span class="sxs-lookup"><span data-stu-id="31b08-167">Open the user Outlook client as the user.</span></span>

2. <span data-ttu-id="31b08-168">Siga los pasos descritos en, [Mostrar la ficha programador](https://support.microsoft.com/office/e1192344-5e56-4d45-931b-e5fd9bea2d45) para la versión de usuario de Outlook.</span><span class="sxs-lookup"><span data-stu-id="31b08-168">Follow the steps in, [Show the Developer tab](https://support.microsoft.com/office/e1192344-5e56-4d45-931b-e5fd9bea2d45) for the users version of Outlook.</span></span>

3. <span data-ttu-id="31b08-169">Abra la pestaña programador ahora visible en Outlook y haga clic en **diseñar un formulario**.</span><span class="sxs-lookup"><span data-stu-id="31b08-169">Open the now visible developer tab in Outlook and click **design a form**.</span></span>

4. <span data-ttu-id="31b08-170">Seleccione la **bandeja de entrada** en la lista **Buscar en** .</span><span class="sxs-lookup"><span data-stu-id="31b08-170">Select the **Inbox** from the **Look In** list.</span></span> <span data-ttu-id="31b08-171">Busque otros formularios personalizados.</span><span class="sxs-lookup"><span data-stu-id="31b08-171">Look for any custom forms.</span></span> <span data-ttu-id="31b08-172">Los formularios personalizados son muy raros que si tiene algún formulario personalizado, merece la pena tener un aspecto más profundo.</span><span class="sxs-lookup"><span data-stu-id="31b08-172">Custom forms are rare enough that if you have any custom forms at all, it is worth a deeper look.</span></span>

5. <span data-ttu-id="31b08-173">Investigue los formularios personalizados, en especial los que están marcados como ocultos.</span><span class="sxs-lookup"><span data-stu-id="31b08-173">Investigate any custom forms, especially those marked as hidden.</span></span>

6. <span data-ttu-id="31b08-174">Abra cualquier formulario personalizado y, en el grupo de **formularios** , haga clic en **Ver código** para ver lo que se ejecuta cuando se carga el formulario.</span><span class="sxs-lookup"><span data-stu-id="31b08-174">Open any custom forms and in the **Form** group click **View Code** to see what runs when the form is loaded.</span></span>

### <a name="steps-to-confirm-the-rules-and-forms-attack-using-powershell"></a><span data-ttu-id="31b08-175">Pasos para confirmar el ataque de reglas y formularios con PowerShell</span><span class="sxs-lookup"><span data-stu-id="31b08-175">Steps to confirm the Rules and Forms attack using PowerShell</span></span>

<span data-ttu-id="31b08-176">La forma más sencilla de comprobar un ataque de reglas o formularios personalizados es ejecutar el script de PowerShell de [Get-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) .</span><span class="sxs-lookup"><span data-stu-id="31b08-176">The simplest way to verify a rules or custom forms attack is to run the [Get-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) PowerShell script.</span></span> <span data-ttu-id="31b08-177">Este script se conecta a todos los buzones del espacio empresarial y vuelca todas las reglas y formularios en dos archivos. csv.</span><span class="sxs-lookup"><span data-stu-id="31b08-177">This script connects to every mailbox in your tenant and dumps all the rules and forms into two .csv files.</span></span>

#### <a name="pre-requisites"></a><span data-ttu-id="31b08-178">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="31b08-178">Pre-requisites</span></span>

<span data-ttu-id="31b08-179">Deberá contar con un derecho de administrador global para ejecutar el script, ya que el script se conecta a todos los buzones del espacio empresarial para leer las reglas y los formularios.</span><span class="sxs-lookup"><span data-stu-id="31b08-179">You will need to have a global administrator rights to run the script because the script connects to every mailbox in the tenancy to read the rules and forms.</span></span>

1. <span data-ttu-id="31b08-180">Inicie sesión en el equipo en el que va a ejecutar el script con derechos de administrador local.</span><span class="sxs-lookup"><span data-stu-id="31b08-180">Sign in to the machine that you will run the script from with local administrator rights.</span></span>

2. <span data-ttu-id="31b08-181">Descargue o copie el script de Get-AllTenantRulesAndForms.ps1 desde GitHub a una carpeta desde la que lo ejecutará.</span><span class="sxs-lookup"><span data-stu-id="31b08-181">Download or copy the Get-AllTenantRulesAndForms.ps1 script from GitHub to a folder from which you will run it.</span></span> <span data-ttu-id="31b08-182">El script creará dos archivos de marcas de fecha en esta carpeta, MailboxFormsExport-yyyy-mm-dd.csv y MailboxRulesExport-yyyy-mm-dd.csv.</span><span class="sxs-lookup"><span data-stu-id="31b08-182">The script will create two date stamped files to this folder, MailboxFormsExport-yyyy-mm-dd.csv, and MailboxRulesExport-yyyy-mm-dd.csv.</span></span>

3. <span data-ttu-id="31b08-183">Abra una instancia de PowerShell como administrador y abra la carpeta en la que guardó el script.</span><span class="sxs-lookup"><span data-stu-id="31b08-183">Open a PowerShell instance as an administrator and open the folder you saved the script to.</span></span>

4. <span data-ttu-id="31b08-184">Ejecute esta línea de comandos de PowerShell de la siguiente manera `.\Get-AllTenantRulesAndForms.ps1`.\Get-AllTenantRulesAndForms.ps1</span><span class="sxs-lookup"><span data-stu-id="31b08-184">Run this PowerShell command line as follows `.\Get-AllTenantRulesAndForms.ps1`.\Get-AllTenantRulesAndForms.ps1</span></span>

#### <a name="interpreting-the-output"></a><span data-ttu-id="31b08-185">Interpretación del resultado</span><span class="sxs-lookup"><span data-stu-id="31b08-185">Interpreting the output</span></span>

- <span data-ttu-id="31b08-186">**MailboxRulesExport-*yyyy-MM-DD*. csv**: Examine las reglas (una por fila) para las condiciones de acción que incluyen aplicaciones o ejecutables:</span><span class="sxs-lookup"><span data-stu-id="31b08-186">**MailboxRulesExport-*yyyy-mm-dd*.csv**: Examine the rules (one per row) for action conditions that include applications or executables:</span></span>

  - <span data-ttu-id="31b08-187">**ActionType (columna A)**: Si ve el valor "ID_ACTION_CUSTOM", es probable que la regla sea malintencionada.</span><span class="sxs-lookup"><span data-stu-id="31b08-187">**ActionType (column A)**: If you see the value "ID_ACTION_CUSTOM", the rule is likely malicious.</span></span>

  - <span data-ttu-id="31b08-188">**IsPotentiallyMalicious (columna D)**: Si este valor es "true", es probable que la regla sea malintencionada.</span><span class="sxs-lookup"><span data-stu-id="31b08-188">**IsPotentiallyMalicious (column D)**: If this value is "TRUE", the rule is likely malicious.</span></span>

  - <span data-ttu-id="31b08-189">**ActionCommand (columna G)**: si se enumera una aplicación o cualquier archivo con una extensión. exe,. zip o una entrada que hace referencia a una dirección URL, que no se supone que esté ahí, es probable que la regla sea malintencionada.</span><span class="sxs-lookup"><span data-stu-id="31b08-189">**ActionCommand (column G)**: If this lists an application or any file with a .exe, .zip extension or an entry that refers to a URL, that is not supposed to be there, the rule is likely malicious.</span></span>

- <span data-ttu-id="31b08-190">**MailboxFormsExport-*yyyy-MM-DD*. csv**: en general, el uso de formularios personalizados es muy raro.</span><span class="sxs-lookup"><span data-stu-id="31b08-190">**MailboxFormsExport-*yyyy-mm-dd*.csv**: In general, the use of custom forms is very rare.</span></span> <span data-ttu-id="31b08-191">Si encuentra algún en este libro, abre el buzón de correo del usuario y examina el propio formulario.</span><span class="sxs-lookup"><span data-stu-id="31b08-191">If you find any in this workbook, you open that user's mailbox and examine the form itself.</span></span> <span data-ttu-id="31b08-192">Si su organización no la puso intencionadamente, es probable que sea malintencionado.</span><span class="sxs-lookup"><span data-stu-id="31b08-192">If your organization did not put it there intentionally, it is likely malicious.</span></span>

## <a name="how-to-stop-and-remediate-the-outlook-rules-and-forms-attack"></a><span data-ttu-id="31b08-193">Cómo detener y corregir el ataque a las reglas y formularios de Outlook</span><span class="sxs-lookup"><span data-stu-id="31b08-193">How to stop and remediate the Outlook Rules and Forms attack</span></span>

<span data-ttu-id="31b08-194">Si encuentra algún indicio de alguno de estos ataques, la corrección es sencilla, simplemente elimine la regla o el formulario del buzón.</span><span class="sxs-lookup"><span data-stu-id="31b08-194">If you find any evidence of either of these attacks, remediation is simple, just delete the rule or form from the mailbox.</span></span> <span data-ttu-id="31b08-195">Puede hacerlo con el cliente de Outlook o con PowerShell remoto para quitar reglas.</span><span class="sxs-lookup"><span data-stu-id="31b08-195">You can do this with the Outlook client or using remote PowerShell to remove rules.</span></span>

### <a name="using-outlook"></a><span data-ttu-id="31b08-196">Uso de Outlook</span><span class="sxs-lookup"><span data-stu-id="31b08-196">Using Outlook</span></span>

1. <span data-ttu-id="31b08-197">Identifique todos los dispositivos que el usuario ha usado con Outlook.</span><span class="sxs-lookup"><span data-stu-id="31b08-197">Identify all the devices that the user has used with Outlook.</span></span> <span data-ttu-id="31b08-198">Todos necesitan limpiarse del posible malware.</span><span class="sxs-lookup"><span data-stu-id="31b08-198">They will all need to be cleaned of potential malware.</span></span> <span data-ttu-id="31b08-199">No permita que el usuario inicie sesión y use el correo electrónico hasta que se limpien todos los dispositivos.</span><span class="sxs-lookup"><span data-stu-id="31b08-199">Do not allow the user to sign on and use email until all the devices are cleaned.</span></span>

2. <span data-ttu-id="31b08-200">Siga los pasos descritos en [eliminar una regla](https://support.microsoft.com/office/2f0e7139-f696-4422-8498-44846db9067f) para cada dispositivo.</span><span class="sxs-lookup"><span data-stu-id="31b08-200">Follow the steps in [Delete a rule](https://support.microsoft.com/office/2f0e7139-f696-4422-8498-44846db9067f) for each device.</span></span>

3. <span data-ttu-id="31b08-201">Si no está seguro de la presencia de otro malware, puede formatear y volver a instalar todo el software en el dispositivo.</span><span class="sxs-lookup"><span data-stu-id="31b08-201">If you are unsure about the presence of other malware, you can format and re-install all the software on the device.</span></span> <span data-ttu-id="31b08-202">Para dispositivos móviles, puede seguir los pasos de los fabricantes para restablecer el dispositivo en la imagen de fábrica.</span><span class="sxs-lookup"><span data-stu-id="31b08-202">For mobile devices you can follow the manufacturers steps to reset the device to the factory image.</span></span>

4. <span data-ttu-id="31b08-203">Instale las versiones más actualizadas de Outlook.</span><span class="sxs-lookup"><span data-stu-id="31b08-203">Install the most up-to-date versions of Outlook.</span></span> <span data-ttu-id="31b08-204">Recuerde que la versión actual de Outlook bloquea ambos tipos de este ataque de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="31b08-204">Remember that the current version of Outlook blocks both types of this attack by default.</span></span>

5. <span data-ttu-id="31b08-205">Una vez que se hayan quitado todas las copias sin conexión del buzón, restablezca la contraseña del usuario (use una alta calidad) y siga los pasos descritos en [configurar la autenticación multifactor para los usuarios](https://docs.microsoft.com/microsoft-365/admin/security-and-compliance/set-up-multi-factor-authentication) si la MFA no se ha habilitado todavía.</span><span class="sxs-lookup"><span data-stu-id="31b08-205">Once all offline copies of the mailbox have been removed, reset the user's password (use a high-quality one) and follow the steps in [Setup multi-factor authentication for users](https://docs.microsoft.com/microsoft-365/admin/security-and-compliance/set-up-multi-factor-authentication) if MFA has not already been enabled.</span></span> <span data-ttu-id="31b08-206">Esto garantiza que las credenciales del usuario no se exponen a través de otros medios (como el phishing o la reutilización de contraseña).</span><span class="sxs-lookup"><span data-stu-id="31b08-206">This ensures that the user's credentials are not exposed via other means (such as phishing or password re-use).</span></span>

### <a name="using-powershell"></a><span data-ttu-id="31b08-207">Mediante PowerShell</span><span class="sxs-lookup"><span data-stu-id="31b08-207">Using PowerShell</span></span>

<span data-ttu-id="31b08-208">Hay dos cmdlets de PowerShell remoto que puede usar para quitar o deshabilitar reglas peligrosas.</span><span class="sxs-lookup"><span data-stu-id="31b08-208">There are two remote PowerShell cmdlets you can use to remove or disable dangerous rules.</span></span> <span data-ttu-id="31b08-209">Solo tiene que seguir los pasos.</span><span class="sxs-lookup"><span data-stu-id="31b08-209">Just follow the steps.</span></span>

#### <a name="steps-for-mailboxes-that-are-on-an-exchange-server"></a><span data-ttu-id="31b08-210">Pasos para buzones de correo que están en un servidor de Exchange</span><span class="sxs-lookup"><span data-stu-id="31b08-210">Steps for mailboxes that are on an Exchange server</span></span>

1. <span data-ttu-id="31b08-211">Conéctese al servidor de Exchange mediante PowerShell remoto.</span><span class="sxs-lookup"><span data-stu-id="31b08-211">Connect to the Exchange server using remote PowerShell.</span></span> <span data-ttu-id="31b08-212">Siga los pasos descritos en [Connect to Exchange Servers Using Remote PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-servers-using-remote-powershell).</span><span class="sxs-lookup"><span data-stu-id="31b08-212">Follow the steps in [Connect to Exchange servers using remote PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-servers-using-remote-powershell).</span></span>

2. <span data-ttu-id="31b08-213">Si desea quitar por completo una sola regla, varias reglas o todas las reglas de un buzón de correo, use el cmdlet [Remove-InboxRule](https://docs.microsoft.com/powershell/module/exchange/Remove-InboxRule) .</span><span class="sxs-lookup"><span data-stu-id="31b08-213">If you want to completely remove a single rule, multiple rules, or all rules from a mailbox use the [Remove-InboxRule](https://docs.microsoft.com/powershell/module/exchange/Remove-InboxRule) cmdlet.</span></span>

3. <span data-ttu-id="31b08-214">Si desea conservar la regla y su contenido para seguir investigando, use el cmdlet [Disable-InboxRule](https://docs.microsoft.com/powershell/module/exchange/disable-inboxrule) .</span><span class="sxs-lookup"><span data-stu-id="31b08-214">If you want to retain the rule and its contents for further investigation use the [Disable-InboxRule](https://docs.microsoft.com/powershell/module/exchange/disable-inboxrule) cmdlet.</span></span>

#### <a name="steps-for-mailboxes-in-exchange-online"></a><span data-ttu-id="31b08-215">Pasos para buzones de correo en Exchange Online</span><span class="sxs-lookup"><span data-stu-id="31b08-215">Steps for mailboxes in Exchange Online</span></span>

1. <span data-ttu-id="31b08-216">Siga los pasos descritos en [Connect to Exchange Online Using PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell).</span><span class="sxs-lookup"><span data-stu-id="31b08-216">Follow the steps in [Connect to Exchange Online using PowerShell](https://docs.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell).</span></span>

2. <span data-ttu-id="31b08-217">Si desea quitar por completo una sola regla, varias reglas o todas las reglas de un buzón de correo, use el cmdlet [Remove-Inbox Rule](https://docs.microsoft.com/powershell/module/exchange/Remove-InboxRule) .</span><span class="sxs-lookup"><span data-stu-id="31b08-217">If you want to completely remove a single rule, multiple rules, or all rules from a mailbox use the [Remove-Inbox Rule](https://docs.microsoft.com/powershell/module/exchange/Remove-InboxRule) cmdlet.</span></span>

3. <span data-ttu-id="31b08-218">Si desea conservar la regla y su contenido para seguir investigando, use el cmdlet [Disable-InboxRule](https://docs.microsoft.com/powershell/module/exchange/disable-inboxrule) .</span><span class="sxs-lookup"><span data-stu-id="31b08-218">If you want to retain the rule and its contents for further investigation use the [Disable-InboxRule](https://docs.microsoft.com/powershell/module/exchange/disable-inboxrule) cmdlet.</span></span>

## <a name="how-to-minimize-future-attacks"></a><span data-ttu-id="31b08-219">Cómo minimizar los ataques futuros</span><span class="sxs-lookup"><span data-stu-id="31b08-219">How to minimize future attacks</span></span>

### <a name="first-protect-your-accounts"></a><span data-ttu-id="31b08-220">Primero: Proteja sus cuentas</span><span class="sxs-lookup"><span data-stu-id="31b08-220">First: protect your accounts</span></span>

<span data-ttu-id="31b08-221">Los atacantes solo usan las reglas y los formularios para aprovechar una vez que han robado o infringido una de sus cuentas de usuario.</span><span class="sxs-lookup"><span data-stu-id="31b08-221">The Rules and Forms exploits are only used by an attacker after they have stolen or breached one of your user's accounts.</span></span> <span data-ttu-id="31b08-222">Por lo tanto, el primer paso para evitar el uso de estos ataques contra su organización es proteger sus cuentas de usuario de forma agresiva.</span><span class="sxs-lookup"><span data-stu-id="31b08-222">So, your first step to preventing the use of these exploits against your organization is to aggressively protect your user accounts.</span></span> <span data-ttu-id="31b08-223">Algunas de las formas más comunes en las que las cuentas se infringen son los ataques de suplantación de identidad (phishing) o de [niebla de contraseña](https://www.dabcc.com/microsoft-defending-against-password-spray-attacks/) .</span><span class="sxs-lookup"><span data-stu-id="31b08-223">Some of the most common ways that accounts are breached are through phishing or [password spraying](https://www.dabcc.com/microsoft-defending-against-password-spray-attacks/) attacks.</span></span>

<span data-ttu-id="31b08-224">La mejor forma de proteger las cuentas de usuario y, especialmente sus cuentas de administrador, es [configurar la autenticación multifactor para los usuarios](https://docs.microsoft.com/microsoft-365/admin/security-and-compliance/set-up-multi-factor-authentication).</span><span class="sxs-lookup"><span data-stu-id="31b08-224">The best way to protect your user accounts, and especially your administrator accounts, is to [set up multi-factor authentication for users](https://docs.microsoft.com/microsoft-365/admin/security-and-compliance/set-up-multi-factor-authentication).</span></span> <span data-ttu-id="31b08-225">También debe hacer lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="31b08-225">You should also:</span></span>

- <span data-ttu-id="31b08-226">Supervisar cómo se [obtiene acceso](https://docs.microsoft.com/azure/active-directory/active-directory-view-access-usage-reports)a las cuentas de usuario y cómo se usan.</span><span class="sxs-lookup"><span data-stu-id="31b08-226">Monitor how your user accounts are [accessed and used](https://docs.microsoft.com/azure/active-directory/active-directory-view-access-usage-reports).</span></span> <span data-ttu-id="31b08-227">No puede evitar la infracción inicial, pero reducirá la duración y el impacto de la infracción al detectarla antes.</span><span class="sxs-lookup"><span data-stu-id="31b08-227">You may not prevent the initial breach, but you will shorten the duration and the impact of the breach by detecting it sooner.</span></span> <span data-ttu-id="31b08-228">Puede usar estas [directivas de seguridad de aplicaciones de nube de Office 365](https://docs.microsoft.com/cloud-app-security/what-is-cloud-app-security) para supervisar sus cuentas y enviar alertas sobre actividades inusuales:</span><span class="sxs-lookup"><span data-stu-id="31b08-228">You can use these [Office 365 Cloud App Security policies](https://docs.microsoft.com/cloud-app-security/what-is-cloud-app-security) to monitor you accounts and alert on unusual activity:</span></span>

  - <span data-ttu-id="31b08-229">**Varios intentos erróneos de inicio de sesión**: esta directiva perfila el entorno y desencadena alertas cuando los usuarios realizan varias actividades de inicio de sesión fallidas en una sola sesión con respecto a la línea base aprendida, lo que podría indicar un intento de infracción.</span><span class="sxs-lookup"><span data-stu-id="31b08-229">**Multiple failed login attempts**: This policy profiles your environment and triggers alerts when users perform multiple failed login activities in a single session with respect to the learned baseline, which could indicate an attempted breach.</span></span>

  - <span data-ttu-id="31b08-230">**Viajes imposibles**: esta directiva perfila el entorno y activa alertas cuando se detectan actividades del mismo usuario en diferentes ubicaciones dentro de un período de tiempo menor que el tiempo de viaje esperado entre las dos ubicaciones.</span><span class="sxs-lookup"><span data-stu-id="31b08-230">**Impossible travel**: This policy profiles your environment and triggers alerts when activities are detected from the same user in different locations within a time period that is shorter than the expected travel time between the two locations.</span></span> <span data-ttu-id="31b08-231">Esto puede indicar que un usuario diferente usa las mismas credenciales.</span><span class="sxs-lookup"><span data-stu-id="31b08-231">This could indicate that a different user is using the same credentials.</span></span> <span data-ttu-id="31b08-232">La detección de este comportamiento anómalo requiere un período inicial de aprendizaje de siete días durante el cual aprende el patrón de actividad de un nuevo usuario.</span><span class="sxs-lookup"><span data-stu-id="31b08-232">Detecting this anomalous behavior necessitates an initial learning period of seven days during which it learns a new user's activity pattern.</span></span>

  - <span data-ttu-id="31b08-233">**Actividad suplantada inusual (por usuario)**: esta directiva perfila el entorno y desencadena alertas cuando los usuarios realizan varias actividades suplantadas en una única sesión con respecto a la línea base aprendida, lo que podría indicar una infracción de intento.</span><span class="sxs-lookup"><span data-stu-id="31b08-233">**Unusual impersonated activity (by user)**: This policy profiles your environment and triggers alerts when users perform multiple impersonated activities in a single session with respect to the baseline learned, which could indicate an attempted breach.</span></span>

- <span data-ttu-id="31b08-234">Aproveche una herramienta como la [puntuación segura de Office 365](https://securescore.office.com/) para administrar los comportamientos y las configuraciones de seguridad de la cuenta.</span><span class="sxs-lookup"><span data-stu-id="31b08-234">Leverage a tool like [Office 365 Secure Score](https://securescore.office.com/) to manage account security configurations and behaviors.</span></span>

### <a name="second-keep-your-outlook-clients-current"></a><span data-ttu-id="31b08-235">Segundo: mantener actualizados los clientes de Outlook</span><span class="sxs-lookup"><span data-stu-id="31b08-235">Second: Keep your Outlook clients current</span></span>

<span data-ttu-id="31b08-236">Las versiones completamente actualizadas y revisadas de Outlook 2013 y 2016 deshabilitan la acción de formulario o regla "Iniciar aplicación" de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="31b08-236">Fully-updated and patched versions of Outlook 2013, and 2016 disable the "Start Application" rule/form action by default.</span></span> <span data-ttu-id="31b08-237">Esto garantizará que, incluso si un atacante infringe la cuenta, se bloquearán las acciones de formulario y regla.</span><span class="sxs-lookup"><span data-stu-id="31b08-237">This will ensure that, even if an attacker breaches the account, the rule and form actions will be blocked.</span></span> <span data-ttu-id="31b08-238">Para instalar las revisiones de seguridad y las actualizaciones más recientes, siga los pasos descritos en [instalar actualizaciones de Office](https://support.microsoft.com/office/2ab296f3-7f03-43a2-8e50-46de917611c5).</span><span class="sxs-lookup"><span data-stu-id="31b08-238">You can install the latest updates and security patches by following the steps in [Install Office updates](https://support.microsoft.com/office/2ab296f3-7f03-43a2-8e50-46de917611c5).</span></span>

<span data-ttu-id="31b08-239">Estas son las versiones de revisión para los clientes de Outlook 2013 y 2016:</span><span class="sxs-lookup"><span data-stu-id="31b08-239">Here are the patch versions for your Outlook 2013 and 2016 clients:</span></span>

- <span data-ttu-id="31b08-240">**Outlook 2016**: 16.0.4534.1001 o superior.</span><span class="sxs-lookup"><span data-stu-id="31b08-240">**Outlook 2016**: 16.0.4534.1001 or greater.</span></span>

- <span data-ttu-id="31b08-241">**Outlook 2013**: 15.0.4937.1000 o superior.</span><span class="sxs-lookup"><span data-stu-id="31b08-241">**Outlook 2013**: 15.0.4937.1000 or greater.</span></span>

<span data-ttu-id="31b08-242">Para obtener más información sobre las revisiones de seguridad individuales, vea:</span><span class="sxs-lookup"><span data-stu-id="31b08-242">For more information on the individual security patches, see:</span></span>

- [<span data-ttu-id="31b08-243">Revisión de seguridad de Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="31b08-243">Outlook 2016 Security Patch</span></span>](https://support.microsoft.com/help/3191883)

- [<span data-ttu-id="31b08-244">Revisión de seguridad de Outlook 2013</span><span class="sxs-lookup"><span data-stu-id="31b08-244">Outlook 2013 Security Patch</span></span>](https://support.microsoft.com/help/3191938)

### <a name="third-monitor-your-outlook-clients"></a><span data-ttu-id="31b08-245">Tercero: Supervise los clientes de Outlook</span><span class="sxs-lookup"><span data-stu-id="31b08-245">Third: Monitor your Outlook clients</span></span>

<span data-ttu-id="31b08-246">Tenga en cuenta que, incluso con las revisiones y actualizaciones instaladas, un atacante puede cambiar la configuración del equipo local para volver a habilitar el comportamiento "Iniciar aplicación".</span><span class="sxs-lookup"><span data-stu-id="31b08-246">Note that even with the patches and updates installed, it is possible for an attacker to change the local machine configuration to re-enable the "Start Application" behavior.</span></span> <span data-ttu-id="31b08-247">Puede usar la [Administración avanzada de directivas de grupo](https://docs.microsoft.com/microsoft-desktop-optimization-pack/agpm/) para supervisar y aplicar directivas de equipo local en los clientes.</span><span class="sxs-lookup"><span data-stu-id="31b08-247">You can use [Advanced Group Policy Management](https://docs.microsoft.com/microsoft-desktop-optimization-pack/agpm/) to monitor and enforce local machine policies on your clients.</span></span>

<span data-ttu-id="31b08-248">Puede ver si "Iniciar aplicación" se ha rehabilitado a través de una invalidación en el registro mediante el uso de la información de [Cómo ver el registro del sistema con las versiones de 64 bits de Windows](https://support.microsoft.com/help/305097).</span><span class="sxs-lookup"><span data-stu-id="31b08-248">You can to see if "Start Application" has been re-enabled through an override in the registry by using the information in [How to view the system registry by using 64-bit versions of Windows](https://support.microsoft.com/help/305097).</span></span> <span data-ttu-id="31b08-249">Compruebe estas subclaves:</span><span class="sxs-lookup"><span data-stu-id="31b08-249">Check these subkeys:</span></span>

- <span data-ttu-id="31b08-250">**Outlook 2016**: `HKEY_CURRENT_USER\Software\Microsoft\Office\16.0\Outlook\Security\`</span><span class="sxs-lookup"><span data-stu-id="31b08-250">**Outlook 2016**: `HKEY_CURRENT_USER\Software\Microsoft\Office\16.0\Outlook\Security\`</span></span>

- <span data-ttu-id="31b08-251">**Outlook 2013**: `HKEY_CURRENT_USER\Software\Microsoft\Office\15.0\Outlook\Security\`</span><span class="sxs-lookup"><span data-stu-id="31b08-251">**Outlook 2013**: `HKEY_CURRENT_USER\Software\Microsoft\Office\15.0\Outlook\Security\`</span></span>

<span data-ttu-id="31b08-252">Busque la clave EnableUnsafeClientMailRules.</span><span class="sxs-lookup"><span data-stu-id="31b08-252">Look for the key EnableUnsafeClientMailRules.</span></span> <span data-ttu-id="31b08-253">Si está y se establece en 1, la revisión de seguridad de Outlook se ha reemplazado y el equipo es vulnerable al ataque de reglas o formularios.</span><span class="sxs-lookup"><span data-stu-id="31b08-253">If it is there and is set to 1, the Outlook security patch has been overridden and the computer is vulnerable to the Form/Rules attack.</span></span> <span data-ttu-id="31b08-254">Si el valor es 0, la acción "Iniciar aplicación" está deshabilitada.</span><span class="sxs-lookup"><span data-stu-id="31b08-254">If the value is 0, the "Start Application" action is disabled.</span></span> <span data-ttu-id="31b08-255">Si está instalada la versión actualizada y revisada de Outlook y esta clave del registro no está presente, un sistema no es vulnerable a estos ataques.</span><span class="sxs-lookup"><span data-stu-id="31b08-255">If the updated and patched version of Outlook is installed and this registry key is not present, then a system is not vulnerable to these attacks.</span></span>

<span data-ttu-id="31b08-256">Los clientes con instalaciones de Exchange locales deben considerar el bloqueo de versiones anteriores de Outlook que no tienen revisiones disponibles.</span><span class="sxs-lookup"><span data-stu-id="31b08-256">Customers with on-premises Exchange installations should consider blocking older versions of Outlook that do not have patches available.</span></span> <span data-ttu-id="31b08-257">Encontrará más información sobre este proceso en el artículo [configure Outlook Client blocking](https://docs.microsoft.com/exchange/configure-outlook-client-blocking-exchange-2013-help).</span><span class="sxs-lookup"><span data-stu-id="31b08-257">Details on this process can be found in the article [Configure Outlook client blocking](https://docs.microsoft.com/exchange/configure-outlook-client-blocking-exchange-2013-help).</span></span>

## <a name="secure-microsoft-365-like-a-cybersecurity-pro"></a><span data-ttu-id="31b08-258">Proteger Microsoft 365 como un profesional de la ciberseguridad</span><span class="sxs-lookup"><span data-stu-id="31b08-258">Secure Microsoft 365 like a cybersecurity pro</span></span>

<span data-ttu-id="31b08-259">Su suscripción a Microsoft 365 incluye un potente conjunto de capacidades de seguridad que puede usar para proteger sus datos y los usuarios.</span><span class="sxs-lookup"><span data-stu-id="31b08-259">Your Microsoft 365 subscription comes with a powerful set of security capabilities that you can use to protect your data and your users.</span></span> <span data-ttu-id="31b08-260">Use el [Plan de seguridad de Microsoft 365: principales prioridades para los primeros 30 días, 90 días y en adelante](security-roadmap.md) para implementar las prácticas recomendadas de Microsoft para proteger su espacio empresarial de Microsoft 365.</span><span class="sxs-lookup"><span data-stu-id="31b08-260">Use the [Microsoft 365 security roadmap - Top priorities for the first 30 days, 90 days, and beyond](security-roadmap.md) to implement Microsoft recommended best practices for securing your Microsoft 365 tenant.</span></span>

- <span data-ttu-id="31b08-261">Tareas a realizar en los primeros 30 días.</span><span class="sxs-lookup"><span data-stu-id="31b08-261">Tasks to accomplish in the first 30 days.</span></span> <span data-ttu-id="31b08-262">Estas tienen un efecto inmediato y de bajo impacto para los usuarios.</span><span class="sxs-lookup"><span data-stu-id="31b08-262">These have immediate affect and are low-impact to your users.</span></span>

- <span data-ttu-id="31b08-263">Tareas para llevar a cabo en 90 días.</span><span class="sxs-lookup"><span data-stu-id="31b08-263">Tasks to accomplish in 90 days.</span></span> <span data-ttu-id="31b08-264">Estas tareas necesitan un poco más de tiempo para planearlas e implementarlas, pero mejoran considerablemente el nivel de seguridad.</span><span class="sxs-lookup"><span data-stu-id="31b08-264">These take a bit more time to plan and implement but greatly improve your security posture.</span></span>

- <span data-ttu-id="31b08-265">Más de 90 días.</span><span class="sxs-lookup"><span data-stu-id="31b08-265">Beyond 90 days.</span></span> <span data-ttu-id="31b08-266">Estas mejoras se crean en el trabajo de los 90 primeros días.</span><span class="sxs-lookup"><span data-stu-id="31b08-266">These enhancements build in your first 90 days work.</span></span>

## <a name="see-also"></a><span data-ttu-id="31b08-267">Vea también:</span><span class="sxs-lookup"><span data-stu-id="31b08-267">See also:</span></span>

- <span data-ttu-id="31b08-268">[Reglas malintencionadas de Outlook](https://silentbreaksecurity.com/malicious-outlook-rules/) por SilentBreak Security post about rules vector proporciona una revisión detallada de las reglas de Outlook.</span><span class="sxs-lookup"><span data-stu-id="31b08-268">[Malicious Outlook Rules](https://silentbreaksecurity.com/malicious-outlook-rules/) by SilentBreak Security Post about Rules Vector provides a detailed review of how the Outlook Rules.</span></span>

- <span data-ttu-id="31b08-269">[MAPI sobre http y Mailrule Pwnage](https://sensepost.com/blog/2016/mapi-over-http-and-mailrule-pwnage/) en el blog de Sensepost acerca de Mailrule Pwnage describe una herramienta denominada regla que le permite aprovechar buzones de correo mediante reglas de Outlook.</span><span class="sxs-lookup"><span data-stu-id="31b08-269">[MAPI over HTTP and Mailrule Pwnage](https://sensepost.com/blog/2016/mapi-over-http-and-mailrule-pwnage/) on the Sensepost blog about Mailrule Pwnage discusses a tool called Ruler that lets you exploit mailboxes through Outlook rules.</span></span>

- <span data-ttu-id="31b08-270">[Formularios y shells de Outlook](https://sensepost.com/blog/2017/outlook-forms-and-shells/) en el blog de Sensepost sobre el vector de amenazas de formularios.</span><span class="sxs-lookup"><span data-stu-id="31b08-270">[Outlook forms and shells](https://sensepost.com/blog/2017/outlook-forms-and-shells/) on the Sensepost blog about Forms Threat Vector.</span></span>

- [<span data-ttu-id="31b08-271">Código base de regla</span><span class="sxs-lookup"><span data-stu-id="31b08-271">Ruler Codebase</span></span>](https://github.com/sensepost/ruler)

- [<span data-ttu-id="31b08-272">Indicadores de compromiso de la regla</span><span class="sxs-lookup"><span data-stu-id="31b08-272">Ruler Indicators of Compromise</span></span>](https://github.com/sensepost/notruler/blob/master/iocs.md)
